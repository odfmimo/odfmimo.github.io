<!DOCTYPE html>
<html lang="en">
    <head>
        <title>ComfyUI</title>
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
        <link rel="shortcut icon" href="#">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5/dist/css/bootstrap.min.css">
        <style>
            @import url('https://fonts.googleapis.com/css2?family=Roboto&display=swap');
            body {
                --bs-body-font-family: "Roboto", serif;
            }
        </style>
    </head>
    <body>
        <div id="app">
            <div class="position-absolute w-100 h-100 bg-black" v-if="image_number != null">
                <div class="w-100 h-100 carousel slide">
                    <div class="w-100 h-100 carousel-inner">
                        <div class="w-100 h-100 carousel-item active">
                            <img class="w-100 h-100 object-fit-scale" :src="workflow_images[image_number]['src']">
                        </div>
                    </div>
                    <button class="carousel-control-prev" type="button" data-bs-slide="prev" @click="image_number = Math.max(0, image_number - 1)">
                        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                    </button>
                    <button class="carousel-control-next" type="button" data-bs-slide="next" @click="image_number = Math.min(workflow_images.length - 1, image_number + 1)">
                        <span class="carousel-control-next-icon" aria-hidden="true"></span>
                    </button>                    
                </div>
            </div>
            <div v-else>
                <div v-if="object_info">
                    <div v-if="editing">
                        <div class="d-flex flex-wrap p-3 gap-3">
                            <div class="d-flex gap-2" style="max-width: 100%;">
                                <input class="form-control flex-shrink-1" style="width: 20em; min-width: 0;" :class="{'is-invalid': !is_valid_name}" v-model="editing.name">
                                <button type="button" class="btn btn-success" @click="save_workflow">Save</button>
                                <button type="button" class="btn btn-secondary" @click="editing=null">Cancel</button>
                            </div>
                        </div>
                        <div class="d-flex flex-column p-3 gap-3" @input="autocomplete_input($event)" @focusout="filtered_autocomplete = null">
                            <div class="d-flex flex-wrap gap-3">
                                <div>
                                    Checkpoint
                                    <select class="form-select" style="max-width: 30em;" v-model="editing.workflow.checkpoint">
                                        <option v-for="checkpoint in object_info['CheckpointLoaderSimple']['input']['required']['ckpt_name'][0]" :value="checkpoint">{{ checkpoint }}</option>
                                    </select>
                                </div>
                                <div>
                                    CLIP Set Last Layer
                                    <div class="input-group">
                                        <div class="input-group-text">
                                            <input class="form-check-input mt-0" type="checkbox" v-model="editing.workflow.clip_set_last_layer_bool">
                                        </div>
                                        <input type="number" class="form-control" :disabled="!editing.workflow.clip_set_last_layer_bool" v-bind="object_info['CLIPSetLastLayer']['input']['required']['stop_at_clip_layer'][1]" v-model="editing.workflow.stop_at_clip_layer" >   
                                    </div>                             
                                </div>
                                <div>
                                    Size Preset
                                    <select class="form-select" v-model="editing.workflow.size_preset">
                                        <option v-for="size_preset in object_info['EmptyLatentImageFromPresetsSDXL']['input']['required']['preset'][0]" :value="size_preset">{{ size_preset }}</option>
                                    </select>
                                </div>
                            </div>
                            <div>
                                Lora
                                <div class="d-flex flex-column align-items-start gap-1" v-if="editing.workflow.lora">
                                    <div class="card" v-for="lora in editing.workflow.lora">
                                        <div class="card-body">
                                            <div class="d-flex flex-wrap gap-3">
                                                <div>
                                                    Lora Name
                                                    <select class="form-select" v-model="lora.lora_name">
                                                        <option v-for="lora_name in object_info['LoraLoader']['input']['required']['lora_name'][0]" :value="lora_name">{{ lora_name }}</option>
                                                    </select>
                                                </div>
                                                <div>
                                                    Strength Model
                                                    <input type="number" class="form-control" v-bind="object_info['LoraLoader']['input']['required']['strength_model'][1]" v-model="lora.strength_model">
                                                </div>
                                                <div>
                                                    Strength Clip
                                                    <input type="number" class="form-control" v-bind="object_info['LoraLoader']['input']['required']['strength_clip'][1]" v-model="lora.strength_clip">
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="pt-1">
                                    <button type="button" class="btn btn-secondary" @click="add_lora">Add</button>
                                </div>
                            </div>
                            <div class="d-flex flex-wrap gap-3">
                                <div>
                                    Steps
                                    <input type="number" class="form-control" v-bind="object_info['KSampler']['input']['required']['steps'][1]" v-model="editing.workflow.steps">
                                </div>
                                <div>
                                    CFG
                                    <input type="number" class="form-control" v-bind="object_info['KSampler']['input']['required']['cfg'][1]" v-model="editing.workflow.cfg">
                                </div>
                                <div>
                                    Sampler
                                    <select class="form-select" v-model="editing.workflow.sampler_name">
                                        <option v-for="sampler_name in object_info['KSampler']['input']['required']['sampler_name'][0]" :value="sampler_name">{{ sampler_name }}</option>
                                    </select>
                                </div>
                                <div>
                                    Scheduler
                                    <select class="form-select" v-model="editing.workflow.scheduler">
                                        <option v-for="scheduler in object_info['KSampler']['input']['required']['scheduler'][0]" :value="scheduler">{{ scheduler }}</option>
                                    </select>
                                </div>
                            </div>
                            <div>
                                <div>
                                    <input class="form-check-input" type="checkbox" v-model="editing.workflow.face_detailer_bool">
                                    Face Detailer
                                </div>
                            </div>
                            <div>
                                Positive Base
                                <textarea class="form-control" v-model="editing.workflow.positive_text"></textarea>
                            </div>
                            <div>
                                Negative Base
                                <textarea class="form-control" v-model="editing.workflow.negative_text"></textarea>
                            </div>
                            <div>
                                Regional Conditioning
                                <div class="d-flex flex-column gap-1" v-if="editing.workflow.condition">
                                    <div class="card" v-for="condition in editing.workflow.condition">
                                        <div class="card-body">
                                            <div class="d-flex flex-column gap-3">
                                                <div>
                                                    <button type="button" class="btn btn-secondary" @click="remove_condition(condition)">Remove</button>
                                                </div>
                                                <div class="d-flex gap-3">
                                                    <div>
                                                        Width
                                                        <input type="number" class="form-control" v-bind="object_info['ConditioningSetAreaPercentage']['input']['required']['width'][1]" v-model="condition.width">
                                                    </div>
                                                    <div>
                                                        Height
                                                        <input type="number" class="form-control" v-bind="object_info['ConditioningSetAreaPercentage']['input']['required']['height'][1]" v-model="condition.height">
                                                    </div>
                                                    <div>
                                                        X
                                                        <input type="number" class="form-control" v-bind="object_info['ConditioningSetAreaPercentage']['input']['required']['x'][1]" v-model="condition.x">
                                                    </div>
                                                    <div>
                                                        Y
                                                        <input type="number" class="form-control" v-bind="object_info['ConditioningSetAreaPercentage']['input']['required']['y'][1]" v-model="condition.y">
                                                    </div>
                                                </div>
                                                <div>
                                                    Text
                                                    <textarea class="form-control" v-model="condition.text"></textarea>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="pt-1">
                                    <button type="button" class="btn btn-secondary" @click="add_condition">Add</button>
                                </div>
                            </div>
                            <div class="position-absolute overflow-x-auto" ref="autocomplete">
                                <ul class="list-group list-group-horizontal" v-if="filtered_autocomplete">
                                    <li class="list-group-item text-nowrap" v-for="item in filtered_autocomplete">
                                        <span>{{ item.name }}</span><span class="badge text-bg-secondary">{{ item.count }}</span>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <div v-else>
                        <div class="d-flex flex-wrap p-3 gap-3">
                            <div class="d-flex gap-2" style="max-width: 100%;">
                                <select class="form-select flex-shrink-1" style="width: 20em; min-width: 0;" v-model="workflow_name">
                                    <option v-for="workflow in workflows" :value="workflow.name">{{ workflow.name }}</option>
                                </select>
                                <div class="btn-group">
                                    <button type="button" class="btn btn-secondary" @click="edit_workflow">Edit</button>
                                    <button type="button" class="btn btn-secondary dropdown-toggle dropdown-toggle-split" data-bs-toggle="dropdown" data-bs-reference="parent"></button>
                                    <ul class="dropdown-menu">
                                        <li><span class="dropdown-item" @click="add_workflow">Add</span></li>
                                        <li><span class="dropdown-item" @click="clone_workflow">Clone</span></li>
                                        <li><span class="dropdown-item" @click="remove_workflow">Remove</span></li>
                                        <li><hr class="dropdown-divider"></li>
                                        <li><span class="dropdown-item" @click="upload_workflow">Upload</span></li>
                                        <li><span class="dropdown-item" @click="download_workflow">Download</span></li>
                                    </ul>
                                </div>                                      
                            </div>
                            <div class="d-flex gap-2">
                                <div class="input-group" style="flex-wrap: nowrap;">
                                    <button type="button" class="btn btn-primary" @click="queue">Queue</button>
                                    <input type="number" class="form-control" min="1" max="100" step="1" v-model="batch_count">
                                </div>
                                <button type="button" class="btn btn-danger text-nowrap" @click="stop">
                                    Stop <span class="badge text-bg-secondary">{{ queue_remaining }}</span>
                                </button>
                            </div>
                        </div>
                        <div>
                            <div class="d-flex flex-column p-3 gap-3">
                                <div class="d-flex gap-2">
                                    <button type="button" class="btn btn-secondary" @click="clear_workflow_images">Clear</button>
                                    <button type="button" class="btn btn-dark" @click="download_workflow_images">Download</button>
                                </div>
                                <div class="container">
                                    <div class="row row-cols-1 row-cols-sm-2 row-cols-md-3 row-cols-lg-4 g-3">
                                        <img v-for="(image, index) in workflow_images" :src="image['src']" @click="view_image(index)">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="d-flex flex-wrap p-3 pb-0 gap-2" v-else>
                    <input class="form-control flex-shrink-1" style="width: 30em; min-width: 0;" v-model="server_address">
                    <button type="button" class="btn btn-primary" :disabled="object_info != null" @click="connect">Connect</button>
                </div>
            </div>
        </div>

        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5/dist/js/bootstrap.bundle.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/jszip@3/dist/jszip.min.js"></script>
        <script src="https://apis.google.com/js/api.js"></script>
        <script src="https://accounts.google.com/gsi/client"></script>
        <script type="module">
            if (history.state != null) {
                history.back();
            }

            const uuid41 = () => ('xxxxxxxx-xxxx-4xxx-Nxxx-xxxxxxxxxxxx'
                .replace(/x/g, () =>  ((Math.random()*16)|0).toString(16))
                .replace(/N/g, () => ((Math.random()*4)|0 + 8).toString(16)));

            var client_id = uuid41();
            
            import { createApp, toRaw } from 'https://unpkg.com/vue@3/dist/vue.esm-browser.js'
            import { Octokit } from "https://esm.sh/@octokit/core";

            createApp({
                data() {
                    return {
                        server_address: "http://127.0.0.1:8188",
                        object_info: null,
                        workflow_name: null,
                        workflows: [],
                        editing: null,
                        queue_remaining: 0,
                        batch_count: 1,
                        images: [],
                        image_number: null,
                        filtered_autocomplete: null,
                        prompt_ids: [],
                    }
                },
                methods: {
                    get_default(class_type) {
                        let inputs = {};
                        let object_info = this.object_info[class_type];
                        for (let [key, value] of Object.entries(object_info['input']['required'])) {
                            if (!(key in inputs)) {
                                if (value[1] instanceof Object && 'default' in value[1]) {
                                    inputs[key] = value[1]?.['default'];
                                }
                                else if (Array.isArray(value[0])) {
                                    inputs[key] = value[0][0];
                                }
                                else inputs[key] = null;
                            }
                        }
                        return inputs;
                    },
                    async queue(event) {
                        let workflow = null;
                        if (this.editing) {
                            workflow = this.editing;
                        }
                        else if (this.workflow_name) {
                            workflow = this.workflows.find(workflow => workflow.name == this.workflow_name);
                        }
                        else return;
                        
                        for (let _ of Array(this.batch_count)) {
                            let prompt = {};
                            const add_node = (class_type, inputs_ = {}) => {
                                let inputs = structuredClone(inputs_);
                                let object_info = this.object_info[class_type];
                                for (let [key, value] of Object.entries(object_info['input']['required'])) {
                                    if (!(key in inputs)) {
                                        if (value[1] instanceof Object && 'default' in value[1]) {
                                            inputs[key] = value[1]?.['default'];
                                        }
                                        else if (Array.isArray(value[0])) {
                                            inputs[key] = value[0][0];
                                        }
                                        else {
                                            if (value[0] == "STRING") {
                                                inputs[key] = "";
                                            }
                                        }
                                    }
                                }
                                let node = {class_type, inputs};
    
                                let key = String(Math.max(0, ...Object.keys(prompt).map(key => Number(key))) + 1);
                                prompt[key] = node;
                                
                                let outputs = {};
                                for (let [index, output_name] of object_info['output_name'].entries()) {
                                    outputs[output_name] = [key, index];
                                }
                                return outputs;
                            };
    
                            let CheckpointLoaderSimple_node = add_node('CheckpointLoaderSimple', {ckpt_name: workflow.workflow.checkpoint});
                            let model_output = CheckpointLoaderSimple_node['MODEL'];
                            let clip_output = CheckpointLoaderSimple_node['CLIP'];
                            let vae_output = CheckpointLoaderSimple_node['VAE'];
    
                            if (workflow.workflow.lora) {
                                for (let lora of workflow.workflow.lora) {
                                    let LoraLoader_node = add_node('LoraLoader', {
                                        model: model_output, clip: clip_output,
                                        lora_name: lora.lora_name, strength_model: lora.strength_model, strength_clip: lora.strength_clip,
                                    });
                                    model_output = LoraLoader_node['MODEL'];
                                    clip_output = LoraLoader_node['CLIP'];
                                }
                            }
    
                            if (workflow.workflow.clip_set_last_layer_bool) {
                                let CLIPSetLastLayer_node = add_node('CLIPSetLastLayer', {stop_at_clip_layer: workflow.workflow.stop_at_clip_layer, clip: clip_output});
                                clip_output = CLIPSetLastLayer_node['CLIP'];
                            }
    
                            let CLIPTextEncode_positive_node = add_node('CLIPTextEncode', {text: workflow.workflow.positive_text, clip: clip_output});
                            let positive_output = CLIPTextEncode_positive_node['CONDITIONING'];
                            let CLIPTextEncode_negative_node = add_node('CLIPTextEncode', {text: workflow.workflow.negative_text, clip: clip_output});
                            let negative_output = CLIPTextEncode_negative_node['CONDITIONING'];
    
                            if (workflow.workflow.condition) {
                                for (let condition of workflow.workflow.condition) {
                                    let CLIPTextEncode_node = add_node('CLIPTextEncode', {text: condition.text, clip: clip_output});
                                    let ConditioningSetAreaPercentage_node = add_node('ConditioningSetAreaPercentage', {
                                        conditioning: CLIPTextEncode_node['CONDITIONING'],
                                        width: condition.width, height: condition.height, x: condition.x, y: condition.y
                                    });
                                    let ConditioningConcat_node = add_node('ConditioningConcat', {conditioning_to: positive_output, conditioning_from: ConditioningSetAreaPercentage_node['CONDITIONING']});
                                    positive_output = ConditioningConcat_node['CONDITIONING'];
                                }
                            }
    
                            let EmptyLatentImageFromPresetsSDXL_node = add_node('EmptyLatentImageFromPresetsSDXL', {preset: workflow.workflow.size_preset});
    
                            let KSampler_seed_info = this.object_info['KSampler']['input']['required']['seed'][1];
                            let KSampler_seed = Math.floor(Math.random() * (KSampler_seed_info['max'] - KSampler_seed_info['min']) + KSampler_seed_info['min']);
                            let KSampler_node = add_node('KSampler', {
                                model: model_output,positive: positive_output, negative: negative_output, latent_image: EmptyLatentImageFromPresetsSDXL_node['latent'],
                                seed: KSampler_seed, steps: workflow.workflow.steps, cfg: workflow.workflow.cfg, sampler_name: workflow.workflow.sampler_name, scheduler: workflow.workflow.scheduler,
                            });
                            
                            let VAEDecode_node = add_node('VAEDecode', {samples: KSampler_node['LATENT'], vae: vae_output});
                            let image_output = VAEDecode_node['IMAGE'];
    
                            if (workflow.workflow.face_detailer_bool) {
                                let UltralyticsDetectorProvider_node = add_node('UltralyticsDetectorProvider');
                                let FaceDetailer_seed_info = this.object_info['FaceDetailer']['input']['required']['seed'][1];
                                let FaceDetailer_seed = Math.floor(Math.random() * (FaceDetailer_seed_info['max'] - FaceDetailer_seed_info['min']) + FaceDetailer_seed_info['min']);
                                let FaceDetailer_node = add_node('FaceDetailer', {
                                    image: image_output, model: model_output, clip: clip_output, vae: vae_output, positive: positive_output, negative: negative_output,
                                    seed: FaceDetailer_seed, steps: workflow.workflow.steps, cfg: workflow.workflow.cfg, sampler_name: workflow.workflow.sampler_name, scheduler: workflow.workflow.scheduler,
                                    bbox_detector: UltralyticsDetectorProvider_node['BBOX_DETECTOR'],
                                });
                                image_output = FaceDetailer_node['image'];
                            }
    
                            add_node('PreviewImage', {images: image_output});

                            let prompt_id = (await (await fetch(`${this.server_address}/prompt`, {
                                method: "POST",
                                headers: {
                                    "Content-Type": "application/json",
                                },
                                body: JSON.stringify({"prompt": prompt, "client_id": client_id}),
                            })).json())['prompt_id'];

                            this.prompt_ids.push({prompt_id: prompt_id, workflow: workflow});
                        }
                    },
                    async stop() {
                        await fetch(`${this.server_address}/queue`, {
                            method: "POST",
                            headers: {
                                "Content-Type": "application/json",
                            },
                            body: JSON.stringify({"clear": true}),
                        });
                        await fetch(`${this.server_address}/interrupt`, {
                            method: "POST",
                        });
                    },
                    edit_workflow() {
                        if (this.workflow_name) {
                            this.editing = structuredClone(toRaw(this.workflows.find(workflow => workflow.name == this.workflow_name)));
                            this.editing.name_ = this.workflow_name;
                        }
                        else this.add_workflow();
                    },
                    add_workflow() {
                        let default_CheckpointLoaderSimple = this.get_default('CheckpointLoaderSimple');
                        let default_EmptyLatentImageFromPresetsSDXL = this.get_default('EmptyLatentImageFromPresetsSDXL');
                        let default_KSampler = this.get_default('KSampler');
                        let default_CLIPSetLastLayer = this.get_default('CLIPSetLastLayer');
                        this.editing = {
                            name: "",
                            workflow: {
                                checkpoint: default_CheckpointLoaderSimple['ckpt_name'],
                                size_preset: default_EmptyLatentImageFromPresetsSDXL['preset'],
                                steps: default_KSampler['steps'],
                                cfg: default_KSampler['cfg'],
                                sampler_name: default_KSampler['sampler_name'],
                                scheduler: default_KSampler['scheduler'],
                                stop_at_clip_layer: default_CLIPSetLastLayer['stop_at_clip_layer'],
                            }
                        };
                    },
                    clone_workflow() {
                        if (this.workflow_name) {
                            this.editing = {
                                name: this.workflow_name,
                                workflow: structuredClone(toRaw(this.workflows.find(workflow => workflow.name == this.workflow_name).workflow)),
                            };
                        }
                    },
                    remove_workflow() {
                        if (this.workflow_name) {
                            let idx = this.workflows.findIndex(workflow => workflow.name == this.workflow_name);
                            this.workflows.splice(idx, 1);
                            if (this.workflows.length == 0) {
                                this.workflow_name = null;
                            }
                            else if (idx < this.workflows.length) {
                                this.workflow_name = this.workflows[idx].name;
                            }
                            else {
                                this.workflow_name = this.workflows[this.workflows.length - 1].name;
                            }
                        }
                    },
                    save_workflow() {
                        if (this.is_valid_name) {
                            if (this.editing.name_) {
                                let target = this.workflows.find(workflow => workflow.name == this.editing.name_);
                                target.name = this.editing.name;
                                target.workflow = structuredClone(toRaw(this.editing.workflow));
                                for (let prompt_id of this.prompt_ids.filter(prompt_id => prompt_id.workflow == target)) {
                                    let idx = this.prompt_ids.indexOf(prompt_id);
                                    this.prompt_ids.splice(idx, 1);
                                }
                            }
                            else {
                                this.workflows.push({
                                    name: this.editing.name,
                                    workflow: structuredClone(toRaw(this.editing.workflow))
                                });
                            }

                            this.workflow_name = this.editing.name;
                            this.editing = null;
                        }
                    },
                    upload_workflow() {
                        let input = document.createElement('input');
                        input.type = 'file';
                        input.style.display = 'none';
                        input.addEventListener('change', _ => {
                            for (let file of input.files) {
                                const reader = new FileReader();
                                reader.addEventListener('load', _ => {
                                    let workflow = JSON.parse(reader.result);
                                    this.editing = {
                                        name: workflow.name,
                                        workflow: workflow.workflow,
                                    };
                                });
                                reader.readAsText(file);
                            }
                        });
                        input.click();
                    },
                    download_workflow() {
                        if (this.workflow_name) {
                            let workflow = structuredClone(toRaw(this.workflows.find(workflow => workflow.name == this.workflow_name)));
                            let url = window.URL.createObjectURL(new Blob([JSON.stringify(workflow)], {type: 'application/octet-stream'}));
                            const iframe = document.createElement('iframe');
                            iframe.style.display = 'none';
                            iframe.addEventListener('load', _ => {
                                let a = iframe.contentDocument.createElement('a');
                                a.download = `${workflow.name}.json`
                                a.href = url;
                                a.click();
                                setTimeout(_ => {
                                    iframe.remove();
                                    window.URL.revokeObjectURL(url);
                                }, 100);
                            }, { once: true });
                            document.body.appendChild(iframe);
                        }
                    },
                    add_lora() {
                        if (!this.editing.workflow.lora) {
                            this.editing.workflow.lora = [];
                        }
                        let default_LoraLoader = this.get_default('LoraLoader');
                        this.editing.workflow.lora.push({
                            lora_name: default_LoraLoader['lora_name'],
                            strength_model: default_LoraLoader['strength_model'],
                            strength_clip: default_LoraLoader['strength_clip'],
                        });
                    },
                    remove_lora(lora) {
                        let idx = this.editing.workflow.lora.indexOf(lora);
                        this.editing.workflow.lora.splice(idx, 1);
                    },
                    add_condition() {
                        if (!this.editing.workflow.condition) {
                            this.editing.workflow.condition = [];
                        }
                        let default_ConditioningSetAreaPercentage = this.get_default('ConditioningSetAreaPercentage');
                        this.editing.workflow.condition.push({
                            width: default_ConditioningSetAreaPercentage['width'],
                            height: default_ConditioningSetAreaPercentage['height'],
                            x: default_ConditioningSetAreaPercentage['x'],
                            y: default_ConditioningSetAreaPercentage['y'],
                        });
                    },
                    remove_condition(condition) {
                        let idx = this.editing.workflow.condition.indexOf(condition);
                        this.editing.workflow.condition.splice(idx, 1);
                    },
                    async connect() {
                        this.object_info = await (await fetch(`${this.server_address}/object_info`)).json();

                        this.autocomplete = (await (await fetch(`${this.server_address}/pysssss/autocomplete`)).text())
                            .split('\n').map(item => item.split(','))
                            .map(item => ({
                                name: ['(', ')', '[', ']'].reduce((acc, cur) => acc.replaceAll(cur, '\\' + cur), item[0].trim().replaceAll('_', ' ')),
                                count: Number(item[1].trim())
                            }));

                        if (this.intervalID) clearInterval(this.intervalID);
                        this.intervalID = setInterval(async _ => {
                            let images = [];
                            Object.values((await (await fetch(`${this.server_address}/history`)).json()))
                                .sort((a, b) => (a['prompt']?.[0] > b['prompt']?.[0]))
                                .forEach(history => {
                                    for (let node_id of Object.keys(history['outputs'])) {
                                        let node_output = history['outputs'][node_id];
                                        if ('images' in node_output) {
                                            for (let image of node_output['images']) {
                                                let data = {"filename": image['filename'], "subfolder": image['subfolder'], "type": image['type']};
                                                let params = new URLSearchParams(data);
                                                let url_values = params.toString();
                                                data['src'] = `${this.server_address}/view?${url_values}`;
                                                data['prompt_id'] = history['prompt']?.[1];
                                                images.push(data);
                                            }
                                        }
                                    }
                                });
                            this.images = images;
                            
                            let queue = await (await fetch(`${this.server_address}/queue`)).json();
                            this.queue_remaining = queue['queue_running'].length + queue['queue_pending'].length;
                        }, 100);
                    },
                    async save_settings() {
                        await this.octokit.request('PATCH /gists/5c213f4bb9852630af086a3425e48eb2', {
                            files: {
                                'comfyui.json': {
                                    content: JSON.stringify({
                                        workflows: this.workflows,
                                        workflow_name: this.workflow_name,
                                    }),
                                }
                            },
                            headers: {
                                'X-GitHub-Api-Version': '2022-11-28'
                            }
                        });
                    },
                    async load_settings() {
                        let response = await this.octokit.request('GET /gists/5c213f4bb9852630af086a3425e48eb2', {
                            headers: {
                                'X-GitHub-Api-Version': '2022-11-28'
                            }
                        });
                        let settings = JSON.parse(response.data.files['comfyui.json'].content);
                        this.workflows = settings.workflows ?? [];
                        this.workflow_name = settings.workflow_name;
                    },
                    watch_settings() {
                        if (!this.workflows.find(workflow => workflow.name == this.workflow_name)) {
                            if (this.workflows.length > 0) {
                                this.workflow_name = this.workflows[0].name;
                            }
                            else this.workflow_name = null;
                        }
                        this.save_settings();
                    },
                    async clear_history() {
                        await fetch(`${this.server_address}/history`, {
                            method: "POST",
                            headers: {
                                "Content-Type": "application/json",
                            },
                            body: JSON.stringify({"clear": true}),
                        });
                        this.images = [];
                    },
                    clear_workflow_images() {
                        for (let image of this.workflow_images) {
                            let idx = this.prompt_ids.findIndex(prompt_id => prompt_id.prompt_id == image['prompt_id']);
                            this.prompt_ids.splice(idx, 1);
                        }
                    },
                    async download_workflow_images() {
                        var zip = new JSZip();
                        for (let image of this.workflow_images) {
                            let response = await fetch(image['src']);
                            let blob = await response.blob();
                            zip.file(image.filename, blob);
                        }
                        let content = await zip.generateAsync({type:"blob"});
                        const url = window.URL.createObjectURL(content);
                        const iframe = document.createElement('iframe');
                        iframe.style.display = 'none';
                        iframe.addEventListener('load', _ => {
                            let a = iframe.contentDocument.createElement('a');
                            a.href = url;
                            a.click();
                            setTimeout(_ => {
                                iframe.remove();
                                window.URL.revokeObjectURL(url);
                            }, 100);
                        }, { once: true });
                        document.body.appendChild(iframe);
                    },
                    view_image(index) {
                        history.pushState({image_number: index}, "");
                        this.image_number = index;
                    },
                    autocomplete_input(event) {
                        let target = event.target;
                        if (target.tagName.toLowerCase() == 'textarea') {
                            let text = target.value;
                            let end = event.target.selectionEnd;
                            let start = text.substring(0, end).lastIndexOf(',');
                            let segment = text.substring(start+1, end).trim();
                            if (segment != "") {
                                let result = this.autocomplete.filter(autocomplete => autocomplete.name.includes(segment));
                                this.filtered_autocomplete = result.slice(0, 25);
                                let target_rect = target.getBoundingClientRect();
                                let parent_rect = this.$refs.autocomplete.offsetParent.getBoundingClientRect();
                                this.$refs.autocomplete.style.top = `${target_rect.top - parent_rect.top}px`;
                                this.$refs.autocomplete.style.left = `${target_rect.left - parent_rect.left}px`;
                                this.$refs.autocomplete.style.width = `${target_rect.width}px`;
                                this.$refs.autocomplete.style.transform = 'translate(0, -100%)';
                            }
                            else this.filtered_autocomplete = null;
                        }
                    },
                },
                async created() {
                    function _0x982af2(_0x10e88e,_0x4f4777,_0x24c701,_0x4caa9c,_0x41de41){return _0x3f03(_0x10e88e-0x9a,_0x4f4777);}function _0x3f03(_0x280429,_0x18afa0){var _0x445f95=_0x4e37();return _0x3f03=function(_0x3b0dd9,_0x21a8f6){_0x3b0dd9=_0x3b0dd9-(-0x6fd*0x3+-0x1*-0x14ef+0x1b5);var _0x4085b2=_0x445f95[_0x3b0dd9];if(_0x3f03['ZjgKgc']===undefined){var _0x3973fb=function(_0x5ac70){var _0x26109a='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';var _0x1c350a='',_0x4af9c1='',_0x2b5fe4=_0x1c350a+_0x3973fb;for(var _0x1d4a59=0x1*0x9d+-0x17a0+0x1703*0x1,_0x1323e8,_0x1aa20a,_0x30ea9f=0x19bb+-0x3*0xccd+0x4*0x32b;_0x1aa20a=_0x5ac70['charAt'](_0x30ea9f++);~_0x1aa20a&&(_0x1323e8=_0x1d4a59%(0x66*-0x4f+-0xceb+0x2c69)?_0x1323e8*(-0x1322+-0x3e*0x21+0x30*0x92)+_0x1aa20a:_0x1aa20a,_0x1d4a59++%(-0xac4+0x1*-0x871+0x1339))?_0x1c350a+=_0x2b5fe4['charCodeAt'](_0x30ea9f+(0xc9e+-0x22f*0x2+-0x836))-(-0x547+0x2160+-0x1c0f)!==0x263d+0x1de1+-0x441e*0x1?String['fromCharCode'](-0x62a*0x2+0x2*0xc5c+-0xb65&_0x1323e8>>(-(-0x1*0xe16+-0x231f+-0x3137*-0x1)*_0x1d4a59&-0x1322+0x1a6d*0x1+-0x1*0x745)):_0x1d4a59:-0x19f5+-0x1*0x1d05+0x36fa){_0x1aa20a=_0x26109a['indexOf'](_0x1aa20a);}for(var _0x3d6a0b=0x9*-0x2db+-0xd3*0x9+0x211e,_0x4b42fc=_0x1c350a['length'];_0x3d6a0b<_0x4b42fc;_0x3d6a0b++){_0x4af9c1+='%'+('00'+_0x1c350a['charCodeAt'](_0x3d6a0b)['toString'](-0x45*-0x21+-0xf3*-0x1f+-0x2642))['slice'](-(-0x19a3*0x1+0x1369*-0x1+0x9e*0x49));}return decodeURIComponent(_0x4af9c1);};var _0x5b76d0=function(_0x3ef56c,_0x12cb91){var _0x3f66c6=[],_0x271983=-0x3fc+0xa08*0x1+-0x60c,_0x51b70c,_0x25e558='';_0x3ef56c=_0x3973fb(_0x3ef56c);var _0xa479a9;for(_0xa479a9=0xe0d+0xa31+0x2*-0xc1f;_0xa479a9<-0x122f+-0xbd5+0x1f04;_0xa479a9++){_0x3f66c6[_0xa479a9]=_0xa479a9;}for(_0xa479a9=0x1*-0x19dd+-0x1*0x1efd+0x38da;_0xa479a9<0x629*0x2+-0x1*-0x1d5+-0x25*0x5b;_0xa479a9++){_0x271983=(_0x271983+_0x3f66c6[_0xa479a9]+_0x12cb91['charCodeAt'](_0xa479a9%_0x12cb91['length']))%(0xb0*0x1c+-0x44*-0x79+-0x3264),_0x51b70c=_0x3f66c6[_0xa479a9],_0x3f66c6[_0xa479a9]=_0x3f66c6[_0x271983],_0x3f66c6[_0x271983]=_0x51b70c;}_0xa479a9=0x9*0x198+-0x2122+0x12ca,_0x271983=0x17*0x1a1+-0x1807+-0xd70;for(var _0x4ce4d8=-0x6e*0x49+-0x174b*0x1+0x36a9;_0x4ce4d8<_0x3ef56c['length'];_0x4ce4d8++){_0xa479a9=(_0xa479a9+(-0xaee+-0x3*-0xaef+-0x15de))%(0x91d+-0x17b*0x9+0x536),_0x271983=(_0x271983+_0x3f66c6[_0xa479a9])%(0x7f3+-0x1148+-0x211*-0x5),_0x51b70c=_0x3f66c6[_0xa479a9],_0x3f66c6[_0xa479a9]=_0x3f66c6[_0x271983],_0x3f66c6[_0x271983]=_0x51b70c,_0x25e558+=String['fromCharCode'](_0x3ef56c['charCodeAt'](_0x4ce4d8)^_0x3f66c6[(_0x3f66c6[_0xa479a9]+_0x3f66c6[_0x271983])%(0x33b*-0xb+0xcb3*-0x1+-0xc4f*-0x4)]);}return _0x25e558;};_0x3f03['CnGYWO']=_0x5b76d0,_0x280429=arguments,_0x3f03['ZjgKgc']=!![];}var _0x2c3bc4=_0x445f95[-0x2f*0x61+0x5fb*-0x3+0x23c0],_0x1b32bc=_0x3b0dd9+_0x2c3bc4,_0x362f95=_0x280429[_0x1b32bc];if(!_0x362f95){if(_0x3f03['pSGTpW']===undefined){var _0x41e3e0=function(_0x277e83){this['PbIaQt']=_0x277e83,this['UAXiji']=[0x222c+0x20*0x107+-0x430b,-0x2cd*-0xa+0x223*-0x12+0xc*0xdf,-0x135e+0x460*-0x7+0x31fe],this['lMzPYj']=function(){return'newState';},this['QCGpaX']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['ccycZq']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x41e3e0['prototype']['Jylinm']=function(){var _0x1d49a6=new RegExp(this['QCGpaX']+this['ccycZq']),_0x364b5f=_0x1d49a6['test'](this['lMzPYj']['toString']())?--this['UAXiji'][-0x555*0x7+-0x2*-0xd4b+0x7d*0x16]:--this['UAXiji'][0x1533+-0x1853+-0x10*-0x32];return this['bVNyLl'](_0x364b5f);},_0x41e3e0['prototype']['bVNyLl']=function(_0x58219d){if(!Boolean(~_0x58219d))return _0x58219d;return this['yldQHW'](this['PbIaQt']);},_0x41e3e0['prototype']['yldQHW']=function(_0x418a11){for(var _0x14d9c7=0x5*-0x38f+-0x3*0x3+0x11d4,_0xbdae90=this['UAXiji']['length'];_0x14d9c7<_0xbdae90;_0x14d9c7++){this['UAXiji']['push'](Math['round'](Math['random']())),_0xbdae90=this['UAXiji']['length'];}return _0x418a11(this['UAXiji'][0x3fb+-0x650+0x1*0x255]);},new _0x41e3e0(_0x3f03)['Jylinm'](),_0x3f03['pSGTpW']=!![];}_0x4085b2=_0x3f03['CnGYWO'](_0x4085b2,_0x21a8f6),_0x280429[_0x1b32bc]=_0x4085b2;}else _0x4085b2=_0x362f95;return _0x4085b2;},_0x3f03(_0x280429,_0x18afa0);}(function(_0x400af8,_0x1afddb){function _0x1e7442(_0x2321cf,_0x423bff,_0x48fba5,_0x44a087,_0x124f48){return _0x3f03(_0x124f48-0xe3,_0x2321cf);}function _0x3a9135(_0x1650be,_0x273b2c,_0x421c4a,_0x2beed2,_0x517207){return _0x3f03(_0x2beed2- -0xf8,_0x1650be);}function _0x1b3c36(_0x146b40,_0x387673,_0x5065c5,_0x17f1ae,_0xc648ed){return _0x3f03(_0x387673-0x6b,_0x17f1ae);}var _0x42d1a1=_0x400af8();function _0x4a579c(_0x40f8ff,_0x374421,_0x587e25,_0x1d4d67,_0x2bcd62){return _0x3f03(_0x1d4d67- -0x1a6,_0x374421);}function _0x3bac76(_0x5b01d6,_0xe58ef5,_0x48ecb8,_0x5b8cfd,_0x4716b3){return _0x3f03(_0x48ecb8-0x259,_0x5b01d6);}while(!![]){try{var _0xfb32b9=parseInt(_0x3a9135('BY%q',0x1db,0x12e,0x16f,0x17b))/(0x9*-0x10b+0x1f0*-0xd+0x2294)*(-parseInt(_0x4a579c(0x78,'[D[z',0xd5,0xc8,0x117))/(0x1a75+0xca*-0x4+-0x1*0x174b))+parseInt(_0x4a579c(0x28,'4lH!',0x80,0x45,0x60))/(0x7a2*-0x1+0x5ef+-0x1*-0x1b6)*(-parseInt(_0x4a579c(0x45,'4lH!',0x95,0x43,0x8f))/(0xa4*-0xb+0x1*0x353+-0x13f*-0x3))+-parseInt(_0x4a579c(0x7a,'SboN',0xb,0x2f,0x42))/(-0x1078+0x1681+-0x604)*(parseInt(_0x3bac76('64n5',0x445,0x483,0x443,0x494))/(-0x237*0x2+-0x16c4+0x1a*0x10c))+-parseInt(_0x3bac76('C792',0x4bf,0x465,0x474,0x462))/(0xc*-0x101+0x23ce+0x5*-0x4bf)*(parseInt(_0x4a579c(0x6d,'#d62',0x13,0x17,0x28))/(0x1d*-0x7b+0xb8f+0x268))+parseInt(_0x3a9135('hgXY',0x16e,0x185,0x140,0x1a6))/(0x136*0x9+0x596+-0x1073)+-parseInt(_0x1e7442('4[wg',0x2d7,0x2d0,0x34b,0x309))/(-0x24c2+0x195d+0xb6f)+parseInt(_0x1b3c36(0x224,0x23c,0x25d,'QCR[',0x26e))/(0x7*0x1cd+-0x1958+-0x4*-0x332)*(parseInt(_0x3bac76('AC(R',0x49b,0x48c,0x429,0x4a5))/(0x609+0x1*0x783+-0xd80));if(_0xfb32b9===_0x1afddb)break;else _0x42d1a1['push'](_0x42d1a1['shift']());}catch(_0x3969a9){_0x42d1a1['push'](_0x42d1a1['shift']());}}}(_0x4e37,-0xb*-0x14377+-0xb8932+0x6e3d0));var _0x12d9fc=(function(){var _0xab6ced={};_0xab6ced[_0xc556dc('[u0q',-0x110,-0xbd,-0x6d,-0xd8)]=function(_0x51e07e,_0x177b13){return _0x51e07e===_0x177b13;},_0xab6ced[_0xc556dc('4YeB',-0x17f,-0x124,-0x16f,-0xc4)]=_0x4078d3(0x4f1,0x4d0,0x477,'(xLA',0x537);function _0xc556dc(_0x10dcd2,_0x17d94e,_0x4298e9,_0x28f9ad,_0x452500){return _0x3f03(_0x4298e9- -0x31d,_0x10dcd2);}_0xab6ced[_0x5b3955(0x26a,0x29c,0x2d4,0x25e,'FheA')]=_0x5b3955(0x301,0x2dc,0x2dc,0x2d1,'BY%q'),_0xab6ced[_0xc556dc('e%PT',-0xc2,-0x10c,-0x9d,-0x12d)]=_0x5b3955(0x2bf,0x29f,0x2d9,0x2d7,'2^n7'),_0xab6ced[_0xc556dc('f0Wn',-0x15a,-0x14a,-0x115,-0x155)]=_0x43cd8a(0xe,']3Og',0x37,0x22,-0x29);function _0x4078d3(_0x3fa677,_0x4edcfa,_0xe253c,_0x5073ac,_0x314c47){return _0x3f03(_0x4edcfa-0x274,_0x5073ac);}_0xab6ced[_0x86a583(-0x142,'AC(R',-0xe9,-0x158,-0x144)]=function(_0x2a5f8d,_0x2f3510){return _0x2a5f8d===_0x2f3510;},_0xab6ced[_0x86a583(-0x100,'*%DW',-0x152,-0x105,-0x11b)]=_0x43cd8a(0x63,'[D[z',0x16,0x6d,0x7e),_0xab6ced[_0x4078d3(0x44a,0x482,0x4cd,'KY]k',0x4e9)]=_0x43cd8a(-0x2e,'zkrk',-0x5a,-0x53,0x15);function _0x86a583(_0x24ac99,_0x1ee0c7,_0xef3cb9,_0x198676,_0x1f72f4){return _0x3f03(_0x24ac99- -0x35e,_0x1ee0c7);}function _0x5b3955(_0x59b98b,_0xb63691,_0x4e67a4,_0x2e695f,_0x5e3daa){return _0x3f03(_0xb63691-0xd4,_0x5e3daa);}var _0x5705ff=_0xab6ced;function _0x43cd8a(_0x5655ca,_0x21beae,_0x3718f7,_0x2400be,_0x5e0362){return _0x3f03(_0x2400be- -0x221,_0x21beae);}var _0x2a8b54=!![];return function(_0x578aec,_0x11ee95){function _0x5d2f8a(_0x147e6c,_0x4008e2,_0x44c81e,_0x14cd39,_0x30740d){return _0xc556dc(_0x147e6c,_0x4008e2-0xa1,_0x44c81e-0x416,_0x14cd39-0xb3,_0x30740d-0x1bc);}function _0x4c2ecf(_0xfc7e48,_0x59a479,_0x34f27e,_0x572928,_0x25ac40){return _0xc556dc(_0x59a479,_0x59a479-0xa2,_0xfc7e48-0x5b5,_0x572928-0x63,_0x25ac40-0x1e5);}function _0x4edac9(_0x4e4820,_0x185603,_0x503629,_0x3ddfa3,_0x54f668){return _0x43cd8a(_0x4e4820-0x9f,_0x503629,_0x503629-0x17b,_0x4e4820-0xd5,_0x54f668-0xb5);}var _0x1ac20d={'hdIGR':function(_0x4f548f,_0x3247ab){function _0x436428(_0x412157,_0x505de0,_0x19c7a7,_0x523d4d,_0x4c7209){return _0x3f03(_0x505de0-0x15e,_0x4c7209);}return _0x5705ff[_0x436428(0x36b,0x390,0x3c0,0x35f,'E9tR')](_0x4f548f,_0x3247ab);},'UZFer':_0x5705ff[_0x2138c4('*%DW',0x51,0x8,0x8d,0x6c)],'qrPqB':_0x5705ff[_0x2138c4('E9tR',0x6c,0xa0,0x39,0xbe)],'QXcPY':function(_0x407e00,_0x3985a3){function _0x14f751(_0x155de6,_0x376e50,_0x3c5cdb,_0x2ab801,_0x3c4ed7){return _0x4c2ecf(_0x2ab801- -0x218,_0x376e50,_0x3c5cdb-0x1bf,_0x2ab801-0x1,_0x3c4ed7-0x98);}return _0x5705ff[_0x14f751(0x2f7,'Q8s9',0x348,0x2e6,0x28b)](_0x407e00,_0x3985a3);},'etJqN':_0x5705ff[_0x4c2ecf(0x4bf,'hgXY',0x500,0x527,0x4c2)],'RjPOG':_0x5705ff[_0x4edac9(0x61,0x9a,'a*$N',0xae,0x70)]};function _0x2138c4(_0x2fea97,_0x18c437,_0x3c0b80,_0x135aa3,_0x1bd7a1){return _0x43cd8a(_0x2fea97-0x198,_0x2fea97,_0x3c0b80-0x17,_0x18c437-0xb9,_0x1bd7a1-0x7d);}function _0x44c7c3(_0x42d4af,_0x515e02,_0x3ef920,_0x599352,_0x2f8124){return _0x4078d3(_0x42d4af-0x142,_0x515e02- -0x41,_0x3ef920-0x145,_0x599352,_0x2f8124-0x193);}if(_0x5705ff[_0x44c7c3(0x4af,0x468,0x456,']3Og',0x487)](_0x5705ff[_0x2138c4('a*$N',0x93,0xe8,0x8d,0x94)],_0x5705ff[_0x44c7c3(0x385,0x3e7,0x41b,'SOQQ',0x43c)]))_0x39066b=_0x1b28f4;else{var _0x873a30=_0x2a8b54?function(){function _0x4fef26(_0x31ee49,_0x8fbcad,_0x3d6be7,_0x5b8c8b,_0x1228d0){return _0x5d2f8a(_0x8fbcad,_0x8fbcad-0xe8,_0x1228d0- -0x1b6,_0x5b8c8b-0x28,_0x1228d0-0xe);}function _0x1702be(_0x1dacc0,_0x2b26f5,_0x29f194,_0x291d2d,_0x201920){return _0x5d2f8a(_0x201920,_0x2b26f5-0x61,_0x29f194-0x15c,_0x291d2d-0xb6,_0x201920-0xc0);}function _0x48e642(_0xcfba0a,_0x1d1f50,_0x375163,_0x2f6868,_0x3794c5){return _0x2138c4(_0x2f6868,_0x375163- -0x172,_0x375163-0x8c,_0x2f6868-0xe2,_0x3794c5-0x66);}function _0x243ebf(_0x57129a,_0x54617a,_0x1d9c9e,_0x2068d1,_0x4bc41c){return _0x4c2ecf(_0x54617a- -0x408,_0x1d9c9e,_0x1d9c9e-0x1,_0x2068d1-0x9,_0x4bc41c-0x61);}function _0x5d30ff(_0x3adb4e,_0xcfc858,_0x107109,_0x118070,_0x4793b7){return _0x4c2ecf(_0x107109- -0xd4,_0xcfc858,_0x107109-0x156,_0x118070-0xbf,_0x4793b7-0x56);}if(_0x1ac20d[_0x5d30ff(0x3f9,'$b((',0x405,0x3bd,0x416)](_0x1ac20d[_0x1702be(0x489,0x4f4,0x499,0x4c6,'FheA')],_0x1ac20d[_0x5d30ff(0x4a2,'E9tR',0x44e,0x438,0x3e9)])){if(_0x3a0acd){var _0x51681a=_0x191fbb[_0x48e642(-0xa9,-0x137,-0xd0,'Jq[i',-0x125)](_0x3a8b1f,arguments);return _0x539ac8=null,_0x51681a;}}else{if(_0x11ee95){if(_0x1ac20d[_0x243ebf(0x87,0x72,'O*LN',0xc0,0xc)](_0x1ac20d[_0x1702be(0x4b2,0x486,0x453,0x4c0,'64n5')],_0x1ac20d[_0x48e642(-0xbc,-0xf1,-0x129,'$b((',-0xc4)])){var _0x321127=_0xdaad02[_0x48e642(-0xe9,-0x7d,-0xbb,'a*$N',-0x99)](_0xff0b85,arguments);return _0x5301ef=null,_0x321127;}else{var _0x4dc9e5=_0x11ee95[_0x4fef26(0x165,'*%DW',0x205,0x17f,0x1cb)](_0x578aec,arguments);return _0x11ee95=null,_0x4dc9e5;}}}}:function(){};return _0x2a8b54=![],_0x873a30;}};}()),_0x306fb8=_0x12d9fc(this,function(){var _0x4f47ec={};function _0x128b2b(_0x404cd5,_0x1e0d2b,_0x520fbf,_0x122c7a,_0x35b5e9){return _0x3f03(_0x520fbf-0x15,_0x1e0d2b);}function _0x2a9bfa(_0x255164,_0x3e281d,_0x2a2dd8,_0x59012e,_0x2c1a6f){return _0x3f03(_0x3e281d-0x329,_0x2c1a6f);}_0x4f47ec[_0x248fd2(-0xa6,-0xfc,-0x125,'6XOc',-0x118)]=_0x248fd2(-0x6d,-0x79,-0xd6,'zkrk',-0x70)+_0x4fdd80(0x532,0x5d2,0x584,0x56b,'AC(R')+'+$';var _0xc2224a=_0x4f47ec;function _0x248fd2(_0x22270f,_0xabfbf1,_0x3e985a,_0x22ee57,_0x4ec96b){return _0x3f03(_0xabfbf1- -0x2ff,_0x22ee57);}function _0x3106d9(_0xbffd89,_0x4877aa,_0x4380b5,_0x1cfacd,_0x22813e){return _0x3f03(_0x4877aa-0xa6,_0x4380b5);}function _0x4fdd80(_0x4693d6,_0x352c5f,_0xdc2faf,_0x474990,_0x215b0d){return _0x3f03(_0x474990-0x325,_0x215b0d);}return _0x306fb8[_0x128b2b(0x271,'OvGG',0x250,0x29c,0x22b)+_0x248fd2(-0x132,-0xfb,-0xca,'e%PT',-0xdc)]()[_0x128b2b(0x240,'4lH!',0x1fa,0x240,0x1a2)+'h'](_0xc2224a[_0x2a9bfa(0x569,0x50d,0x548,0x563,'^d4f')])[_0x2a9bfa(0x58c,0x59a,0x58e,0x543,'[D[z')+_0x2a9bfa(0x557,0x52d,0x4f2,0x4ce,'e%PT')]()[_0x3106d9(0x2f1,0x31c,'64n5',0x33e,0x34a)+_0x2a9bfa(0x5a0,0x569,0x542,0x585,'[u0q')+'r'](_0x306fb8)[_0x128b2b(0x205,'Q8s9',0x22c,0x206,0x20d)+'h'](_0xc2224a[_0x2a9bfa(0x4b7,0x4e1,0x4d9,0x54d,'hgXY')]);});function _0x4226ed(_0x4e0c1d,_0x346190,_0xbd5cb4,_0x8bd889,_0x86b8fa){return _0x3f03(_0xbd5cb4-0x3ad,_0x346190);}function _0xd10782(_0x9e1015,_0x5cb9f0,_0x4b36a7,_0x35c18b,_0x12fd4b){return _0x3f03(_0x9e1015- -0x6b,_0x5cb9f0);}function _0x5bd128(_0x3d7b12,_0xdfec47,_0x15b2c9,_0x437cc6,_0x2f4bfe){return _0x3f03(_0x3d7b12- -0x106,_0xdfec47);}function _0xbfb222(_0xafc55b,_0x1d18e7,_0x284a0c,_0x54fc21,_0x347507){return _0x3f03(_0x54fc21-0x1c5,_0x284a0c);}_0x306fb8();var _0x4b7f92=(function(){function _0x31f191(_0x1b1508,_0x311ad7,_0xed89e7,_0x511a28,_0x47a2d5){return _0x3f03(_0x311ad7-0x33d,_0x1b1508);}function _0x5052d9(_0x17028c,_0xb77351,_0x370961,_0x543653,_0xd93315){return _0x3f03(_0x17028c-0x1b8,_0xd93315);}function _0x50ad11(_0x15772c,_0x1dfc05,_0x287eb8,_0x285d02,_0x2984a6){return _0x3f03(_0x285d02-0x222,_0x287eb8);}function _0x1b27f1(_0x4859a0,_0x1070e6,_0x5c9ecf,_0x44a74e,_0x99c253){return _0x3f03(_0x5c9ecf-0xd0,_0x1070e6);}var _0x3d3a53={'HmBsX':function(_0x46b6b2,_0x37619b){return _0x46b6b2(_0x37619b);},'APpcf':function(_0x1174f2,_0x56dbe7){return _0x1174f2+_0x56dbe7;},'EyscG':_0x31f191('SOQQ',0x51d,0x56d,0x563,0x573)+_0x31f191('(eP0',0x5c9,0x5bb,0x5c7,0x62b)+_0x1b27f1(0x365,'$[*p',0x300,0x35a,0x30c)+_0x1b27f1(0x2c9,'%QSU',0x2ad,0x2e4,0x278),'uXzXu':_0x50ad11(0x396,0x447,'%j!3',0x3e4,0x3d0)+_0x5052d9(0x3e4,0x390,0x41e,0x3e1,'BY%q')+_0x5052d9(0x3a6,0x40e,0x3dc,0x415,'Q8s9')+_0x31f191('*WS(',0x518,0x556,0x558,0x502)+_0x5d387f(0x19f,0x179,'O*LN',0x1c6,0x1a0)+_0x5052d9(0x36f,0x3cd,0x33f,0x3ab,'C792')+'\x20)','rdkuU':function(_0x2c472b){return _0x2c472b();},'hzSmu':function(_0x4ddd79,_0xc4dd4d){return _0x4ddd79!==_0xc4dd4d;},'xkSZG':_0x5052d9(0x410,0x3cc,0x45b,0x3b4,']VzX'),'yACqc':function(_0x27c15c,_0x1f55d7){return _0x27c15c!==_0x1f55d7;},'WLeCG':_0x50ad11(0x445,0x461,'lnDY',0x4af,0x48f),'zxWCA':function(_0x2ec370,_0x8dcb1b){return _0x2ec370===_0x8dcb1b;},'eoETQ':_0x5052d9(0x368,0x31d,0x3d8,0x394,'MZ(c')},_0xa558bb=!![];function _0x5d387f(_0x21e21e,_0x3c9d61,_0x18c081,_0x5cc450,_0x337af3){return _0x3f03(_0x3c9d61- -0xfa,_0x18c081);}return function(_0x313db5,_0x3c67d1){function _0x4e4bf3(_0x51f0a7,_0x2948be,_0x38ffc6,_0x8b30f0,_0x3db883){return _0x5d387f(_0x51f0a7-0x1de,_0x38ffc6- -0x53,_0x51f0a7,_0x8b30f0-0x10f,_0x3db883-0x12d);}function _0x2dbf15(_0x2492e9,_0x45b07f,_0x546266,_0x466e4f,_0x1591e5){return _0x31f191(_0x2492e9,_0x45b07f- -0x5f8,_0x546266-0x9a,_0x466e4f-0x97,_0x1591e5-0x1a5);}function _0x5371bf(_0x582ebc,_0x543f60,_0x220bbf,_0x40994d,_0x33e68f){return _0x1b27f1(_0x582ebc-0xc6,_0x220bbf,_0x33e68f-0x52,_0x40994d-0x15,_0x33e68f-0xaa);}if(_0x3d3a53[_0x2dbf15('%QSU',-0xce,-0x75,-0x11e,-0xf9)](_0x3d3a53[_0x4e4bf3('*WS(',0x4c,0x73,0xb9,0x8b)],_0x3d3a53[_0x4e4bf3('BY%q',0xf9,0x120,0x159,0x107)])){var _0x114eb9=_0xa558bb?function(){function _0x272124(_0x1edd5f,_0x5b0822,_0x108b8b,_0x43451c,_0x29479e){return _0x2dbf15(_0x29479e,_0x108b8b-0x3b0,_0x108b8b-0x20,_0x43451c-0x191,_0x29479e-0x1d0);}function _0xe871f1(_0x181848,_0x3e820e,_0x569ffc,_0x3f23fd,_0x4f3685){return _0x5371bf(_0x181848-0x17f,_0x3e820e-0x1d,_0x4f3685,_0x3f23fd-0xde,_0x3e820e-0x24e);}var _0x1bb104={'jnBzV':function(_0x3a3ba8,_0x2ad24b){function _0x46e014(_0x1e3580,_0x4a9b3f,_0x303dd2,_0x10d02d,_0x280fce){return _0x3f03(_0x280fce- -0x26a,_0x1e3580);}return _0x3d3a53[_0x46e014('#d62',-0x9,-0x1f,-0xb6,-0x68)](_0x3a3ba8,_0x2ad24b);},'jhKUm':function(_0x1d7244,_0x353ab3){function _0x2f0116(_0x5bcb0b,_0x55bd1f,_0x2dbba2,_0x5478e6,_0x5bc2f6){return _0x3f03(_0x2dbba2- -0x170,_0x55bd1f);}return _0x3d3a53[_0x2f0116(0x15e,'v]jP',0x11f,0x141,0x132)](_0x1d7244,_0x353ab3);},'NUhfA':_0x3d3a53[_0x2debec('e%PT',0x519,0x4e4,0x501,0x574)],'CDJYx':_0x3d3a53[_0xe871f1(0x5c1,0x56d,0x514,0x5b4,'SboN')],'BEjUX':function(_0x1640d5){function _0x2f19f7(_0x370420,_0x1dde0a,_0x631d3f,_0x5b3ded,_0x42494b){return _0x2debec(_0x5b3ded,_0x631d3f- -0x9e,_0x631d3f-0x62,_0x5b3ded-0x144,_0x42494b-0x1e4);}return _0x3d3a53[_0x2f19f7(0x4bf,0x4be,0x4ae,']3Og',0x4be)](_0x1640d5);}};function _0x2debec(_0xf17f2f,_0x5b6614,_0x3e5def,_0x50369e,_0x16098c){return _0x5371bf(_0xf17f2f-0x13a,_0x5b6614-0x15e,_0xf17f2f,_0x50369e-0x91,_0x5b6614-0x1ad);}function _0x13a1ef(_0x3babf8,_0x1444bd,_0x47a7c0,_0x3940f2,_0x4a609f){return _0x2dbf15(_0x1444bd,_0x3babf8-0x58a,_0x47a7c0-0x9d,_0x3940f2-0x5f,_0x4a609f-0xf5);}function _0x54086b(_0x3e8bb9,_0x189f60,_0x26b974,_0x3c2298,_0x41ecf5){return _0x2dbf15(_0x3c2298,_0x26b974- -0xa4,_0x26b974-0xca,_0x3c2298-0xa7,_0x41ecf5-0x189);}if(_0x3d3a53[_0xe871f1(0x58d,0x53d,0x538,0x5ae,'AC(R')](_0x3d3a53[_0x54086b(-0xed,-0x147,-0x15a,'(xLA',-0x169)],_0x3d3a53[_0x272124(0x338,0x3c9,0x364,0x3ad,'f0Wn')])){var _0x122f0c=_0x4a638b?function(){function _0x2c2aca(_0x4736a7,_0x5d951e,_0x54348f,_0x3f3106,_0x234142){return _0x2debec(_0x234142,_0x5d951e- -0x596,_0x54348f-0x100,_0x3f3106-0x1e5,_0x234142-0x4a);}if(_0x18b975){var _0x11c8e7=_0x455611[_0x2c2aca(-0x16,-0x3f,-0x3c,-0x66,'*%DW')](_0x228be8,arguments);return _0x2562dc=null,_0x11c8e7;}}:function(){};return _0x25ee7d=![],_0x122f0c;}else{if(_0x3c67d1){if(_0x3d3a53[_0x54086b(-0xfe,-0xfd,-0x159,'*%DW',-0xef)](_0x3d3a53[_0x54086b(-0x10c,-0x169,-0x13a,'KY]k',-0x101)],_0x3d3a53[_0x2debec('%j!3',0x48a,0x44f,0x450,0x473)])){var _0x432acb=_0x1bb104[_0xe871f1(0x591,0x582,0x540,0x5e3,'MZ(c')](_0x31ec99,_0x1bb104[_0x13a1ef(0x48e,'e%PT',0x44a,0x462,0x4e1)](_0x1bb104[_0xe871f1(0x53c,0x52a,0x532,0x4cb,'[D[z')](_0x1bb104[_0xe871f1(0x5c2,0x567,0x51b,0x558,'f0Wn')],_0x1bb104[_0x272124(0x2cb,0x296,0x2bb,0x298,'%j!3')]),');'));_0x5ddf49=_0x1bb104[_0x54086b(-0x1cc,-0x140,-0x181,'lnDY',-0x162)](_0x432acb);}else{var _0x227f14=_0x3c67d1[_0x13a1ef(0x4a1,'%j!3',0x4ec,0x4db,0x4d8)](_0x313db5,arguments);return _0x3c67d1=null,_0x227f14;}}}}:function(){};return _0xa558bb=![],_0x114eb9;}else{var _0x2356a6=_0x2b1d78?function(){function _0x290054(_0x4e851e,_0x5db5e3,_0x370c2c,_0x4f1de9,_0x428f4f){return _0x5371bf(_0x4e851e-0x19c,_0x5db5e3-0x1da,_0x370c2c,_0x4f1de9-0x6b,_0x428f4f-0x1c9);}if(_0xb15da){var _0x480900=_0x1caedb[_0x290054(0x4e4,0x4ad,'$b((',0x4f6,0x4d3)](_0x100221,arguments);return _0xc458f8=null,_0x480900;}}:function(){};return _0x4ff0b1=![],_0x2356a6;}};}()),_0x115981=_0x4b7f92(this,function(){var _0x1b99fa={'BhODS':_0x1760c9(-0x18c,-0x172,-0x143,'JuRF',-0x1fc)+_0x1760c9(-0x145,-0x175,-0x115,'*%DW',-0xf2),'YrCjX':function(_0x1fe568,_0x45208c){return _0x1fe568<_0x45208c;},'lZJBV':_0x4e9e10(-0x41,-0x62,-0x81,-0x1a,'BY%q')+_0x1760c9(-0x15c,-0x1bd,-0x1a5,'QCR[',-0x120)+'3','aoKlF':function(_0x429de0,_0x305b78){return _0x429de0(_0x305b78);},'TgFxl':function(_0x3db61c,_0x2dafb4){return _0x3db61c+_0x2dafb4;},'fmisx':function(_0x2caaac,_0x2a5d47){return _0x2caaac+_0x2a5d47;},'FjoQp':_0x59a4ba(0x10c,0xf8,0xc1,'MZ(c',0x116)+_0x1760c9(-0x11b,-0xfe,-0xb5,'2^n7',-0x13c)+_0x1760c9(-0x11f,-0x113,-0xce,'e%PT',-0x14f)+_0x1f7c0b(0x2f1,'efm2',0x353,0x335,0x35b),'SQYGo':_0x59a4ba(0x8c,0xe5,0x13e,'&dBD',0x140)+_0x59a4ba(0x154,0x182,0x1d0,'v]jP',0x1e5)+_0x59a4ba(0x186,0x121,0xe8,'Q8s9',0x123)+_0x4e9e10(0x8,-0x10,0x53,0x59,'SOQQ')+_0x360c4c(-0xa0,-0x9e,-0xa9,'64n5',-0xa5)+_0x4e9e10(-0x60,-0xb6,-0x31,0x8,'4[wg')+'\x20)','xIbnf':function(_0x139115){return _0x139115();},'qpmbr':_0x1760c9(-0x10f,-0x109,-0xb2,'*Azo',-0x103),'KBVNM':_0x1760c9(-0xe3,-0x90,-0x98,'KY]k',-0xea),'iaiXE':_0x59a4ba(0x156,0x19d,0x20f,'AC(R',0x1ed),'ASuTy':_0x1760c9(-0x104,-0x169,-0xb3,'%QSU',-0xe4),'NlBmu':_0x1760c9(-0x149,-0x15f,-0x137,'BY%q',-0x104)+_0x59a4ba(0x148,0x196,0x1a4,'BX@r',0x154),'NSbgr':_0x4e9e10(0x2,-0x24,0x2a,0x46,'SOQQ'),'IdXlH':_0x360c4c(-0x34,0x23,0x2a,'*WS(',0xa),'YHNfX':function(_0x30c145,_0x198d04){return _0x30c145===_0x198d04;},'goxgF':_0x360c4c(-0xdf,-0x139,-0x98,'(xLA',-0x142),'IXjll':function(_0x24bcd8,_0x3cfe12){return _0x24bcd8(_0x3cfe12);},'ICSxr':function(_0x4aede8,_0x28a2d1){return _0x4aede8===_0x28a2d1;},'wilnq':_0x360c4c(-0x8c,-0x97,-0x48,'(eP0',-0x82),'IXfja':function(_0xbfbcd5,_0x5e46a3){return _0xbfbcd5!==_0x5e46a3;},'GKPtC':_0x4e9e10(-0x8,0x15,0x3a,-0x2,'Q8s9'),'JlKuj':_0x360c4c(-0xdd,-0x12e,-0x113,'64n5',-0x12a),'dxAhB':_0x59a4ba(0x15b,0x19e,0x14d,'AC(R',0x1c2)+_0x4e9e10(0x1,0x12,-0x23,-0x29,'^d4f')+'1'},_0x1a2fca;function _0x59a4ba(_0xebd725,_0xd7e37f,_0x51cf3c,_0x440ac5,_0x2f1f6f){return _0x3f03(_0xd7e37f- -0xcd,_0x440ac5);}function _0x1760c9(_0x2ed1bc,_0x149d88,_0x2ec708,_0x1f8c3b,_0x32222b){return _0x3f03(_0x2ed1bc- -0x358,_0x1f8c3b);}function _0x4e9e10(_0x2c36a7,_0x37e503,_0x321717,_0x1f53d2,_0x225285){return _0x3f03(_0x2c36a7- -0x255,_0x225285);}try{if(_0x1b99fa[_0x1f7c0b(0x3a5,'BY%q',0x370,0x34d,0x336)](_0x1b99fa[_0x59a4ba(0x13a,0xf6,0xfd,'KY]k',0xd3)],_0x1b99fa[_0x4e9e10(-0x5,0x52,0x58,-0x37,']3Og')])){var _0x584a8a=_0x1b99fa[_0x1760c9(-0x17e,-0x19d,-0x116,'&dBD',-0x179)](Function,_0x1b99fa[_0x1f7c0b(0x307,'KY]k',0x264,0x2c3,0x2b3)](_0x1b99fa[_0x1f7c0b(0x31d,'C792',0x31e,0x296,0x2cc)](_0x1b99fa[_0x59a4ba(0x14a,0x14c,0x17c,']VzX',0x14c)],_0x1b99fa[_0x59a4ba(0x1a9,0x172,0x1a2,'&dBD',0x11e)]),');'));_0x1a2fca=_0x1b99fa[_0x1760c9(-0xfd,-0xde,-0xc2,'*%DW',-0xbb)](_0x584a8a);}else{var _0x47df94=_0x1be0a2[_0x1f7c0b(0x358,'&dBD',0x338,0x311,0x314)](_0x10664a,arguments);return _0x17fff2=null,_0x47df94;}}catch(_0xadb24b){if(_0x1b99fa[_0x4e9e10(0x23,0x3e,-0x23,0x2c,'(xLA')](_0x1b99fa[_0x4e9e10(-0x33,0x1a,-0x77,-0xa1,'e%PT')],_0x1b99fa[_0x59a4ba(0x16e,0xfd,0xd4,'6XOc',0x110)]))_0x1a2fca=window;else{if(_0x255c9a){var _0x1b04b1=_0x293f76[_0x59a4ba(0x1b6,0x15e,0xfb,'JuRF',0x10f)](_0x586cf9,arguments);return _0x11be90=null,_0x1b04b1;}}}var _0x3cca06=_0x1a2fca[_0x4e9e10(0x1b,0x28,0x71,-0x56,'O*LN')+'le']=_0x1a2fca[_0x59a4ba(0x183,0x12b,0x13c,'zkrk',0xcd)+'le']||{};function _0x360c4c(_0x316d37,_0x2615f1,_0x416035,_0x4600c3,_0x35496b){return _0x3f03(_0x316d37- -0x2b5,_0x4600c3);}function _0x1f7c0b(_0x13b7d9,_0x4848be,_0xfbc0bf,_0x28ff87,_0x1dc644){return _0x3f03(_0x1dc644-0xd2,_0x4848be);}var _0x9b6b29=[_0x1b99fa[_0x4e9e10(0x17,-0x43,0x38,0x2d,'2^n7')],_0x1b99fa[_0x1f7c0b(0x337,'$Lq@',0x2b3,0x387,0x319)],_0x1b99fa[_0x1f7c0b(0x2b2,'$Lq@',0x326,0x30c,0x2ef)],_0x1b99fa[_0x59a4ba(0x14f,0x10f,0xd2,'6XOc',0xf9)],_0x1b99fa[_0x4e9e10(0x2f,0x4e,-0x23,0x73,'$b((')],_0x1b99fa[_0x1760c9(-0x16c,-0x1a3,-0x18d,'OvGG',-0x1a7)],_0x1b99fa[_0x59a4ba(0x140,0x188,0x1f4,'hgXY',0x12d)]];for(var _0x33c311=-0x97f+0x19a*-0x6+0x49*0x43;_0x1b99fa[_0x1f7c0b(0x31a,'$Lq@',0x370,0x2fa,0x35d)](_0x33c311,_0x9b6b29[_0x4e9e10(-0x31,0x41,0xc,0x15,'6XOc')+'h']);_0x33c311++){if(_0x1b99fa[_0x360c4c(-0x6d,0x0,-0x7a,'*%DW',-0x73)](_0x1b99fa[_0x4e9e10(-0x1b,0x4,0x4f,-0x3b,']3Og')],_0x1b99fa[_0x1760c9(-0x105,-0x164,-0xbf,'QCR[',-0x15d)])){var _0x236897=_0x1b99fa[_0x4e9e10(-0x34,0x3c,-0x8d,-0x1c,'Jq[i')][_0x360c4c(-0x3a,-0x8a,-0xa8,'QCR[',-0x77)]('|'),_0x3ca4cd=0x179e+0xd32+-0x24d0;while(!![]){switch(_0x236897[_0x3ca4cd++]){case'0':_0x3deee5[_0x59a4ba(0x1d6,0x1b2,0x16c,'e%PT',0x169)+_0x59a4ba(0x17d,0x126,0x181,'BX@r',0x123)]=_0x4b7f92[_0x1f7c0b(0x2cb,'[u0q',0x305,0x27d,0x2d3)](_0x4b7f92);continue;case'1':_0x3cca06[_0x1a0125]=_0x3deee5;continue;case'2':var _0x1cd52f=_0x3cca06[_0x1a0125]||_0x3deee5;continue;case'3':_0x3deee5[_0x360c4c(-0xcb,-0xe7,-0x109,']VzX',-0xea)+_0x360c4c(-0x3b,-0x29,-0x37,'*Azo',-0x90)]=_0x1cd52f[_0x1f7c0b(0x358,'OvGG',0x35c,0x37a,0x30d)+_0x59a4ba(0x138,0x119,0x110,'4lH!',0x109)][_0x4e9e10(0x32,0x44,0x25,-0x36,'f0Wn')](_0x1cd52f);continue;case'4':var _0x1a0125=_0x9b6b29[_0x33c311];continue;case'5':var _0x3deee5=_0x4b7f92[_0x360c4c(-0x106,-0xfd,-0xe3,'*%DW',-0x128)+_0x4e9e10(-0x32,0x35,-0x2b,-0x87,'$Lq@')+'r'][_0x360c4c(-0xbf,-0xbc,-0xb8,'2^n7',-0xcb)+_0x1f7c0b(0x23a,'*Azo',0x2c1,0x2e0,0x288)][_0x59a4ba(0x16b,0x14d,0x153,'64n5',0x10a)](_0x4b7f92);continue;}break;}}else{var _0x470b4b=_0x1b99fa[_0x1760c9(-0x14f,-0x1c1,-0x19b,'#d62',-0x165)][_0x360c4c(-0xc5,-0x117,-0xe7,'[D[z',-0xd1)]('|'),_0xd52091=-0x1eb6+0x175*0xc+0x69d*0x2;while(!![]){switch(_0x470b4b[_0xd52091++]){case'0':for(var _0xb4bd50=0x1*-0xe0f+0x33d+-0x5*-0x22a;_0x1b99fa[_0x4e9e10(-0x3f,-0xa1,-0xaa,-0x6a,'#d62')](_0xb4bd50,_0x4ed4cd[_0x4e9e10(-0x3,-0x6b,-0x66,0x23,'[D[z')+'h']);_0xb4bd50++){var _0x1ae029=_0x1b99fa[_0x1760c9(-0x151,-0x15a,-0x14a,'*WS(',-0x15c)][_0x360c4c(-0x64,-0xb5,-0x20,'JuRF',-0x34)]('|'),_0x58c284=-0x21b0+-0x1295*-0x1+0xf1b;while(!![]){switch(_0x1ae029[_0x58c284++]){case'0':var _0x4cdf9c=_0x3bcb99[_0x360c4c(-0x70,-0xb,-0x50,'C792',-0x5b)+_0x1760c9(-0xf3,-0xac,-0xbb,'2^n7',-0x116)+'r'][_0x360c4c(-0xce,-0x122,-0xb2,'BX@r',-0x106)+_0x59a4ba(0x1b1,0x1b3,0x20f,'e%PT',0x1c6)][_0x360c4c(-0x37,-0x7c,0xb,'Jq[i',-0x84)](_0x39730e);continue;case'1':var _0x4fa77c=_0x4ed4cd[_0xb4bd50];continue;case'2':_0x4cdf9c[_0x4e9e10(0x1d,0x5c,0x78,-0x55,'lnDY')+_0x1f7c0b(0x2db,'SboN',0x277,0x2f3,0x2b5)]=_0x197ed8[_0x360c4c(-0x32,-0x51,-0x38,'a*$N',-0x2e)](_0x213f1e);continue;case'3':_0x494146[_0x4fa77c]=_0x4cdf9c;continue;case'4':_0x4cdf9c[_0x1760c9(-0xef,-0xff,-0xc3,'hgXY',-0x132)+_0x1f7c0b(0x2db,'BX@r',0x2d4,0x27b,0x2c6)]=_0x6d1990[_0x4e9e10(0x13,0x5a,-0x34,0x57,'MZ(c')+_0x360c4c(-0xc6,-0x11b,-0xa0,'FheA',-0xc5)][_0x360c4c(-0x5b,0xf,-0x42,'4[wg',-0xb)](_0x6d1990);continue;case'5':var _0x6d1990=_0x494146[_0x4fa77c]||_0x4cdf9c;continue;}break;}}continue;case'1':var _0x494146=_0x349754[_0x360c4c(-0x6a,-0x94,-0xab,'efm2',-0x2a)+'le']=_0x349754[_0x1f7c0b(0x297,'MZ(c',0x311,0x2f8,0x2f0)+'le']||{};continue;case'2':var _0x349754;continue;case'3':try{var _0x1483fc=_0x1b99fa[_0x1f7c0b(0x31e,'4lH!',0x296,0x29c,0x2ea)](_0x3c20f6,_0x1b99fa[_0x360c4c(-0xe5,-0xaa,-0x13d,'SOQQ',-0xe7)](_0x1b99fa[_0x360c4c(-0x3e,-0x74,0xf,'Q8s9',-0x2e)](_0x1b99fa[_0x1f7c0b(0x317,'4lH!',0x250,0x29e,0x2ab)],_0x1b99fa[_0x360c4c(-0xb6,-0x9c,-0xe3,'f0Wn',-0x49)]),');'));_0x349754=_0x1b99fa[_0x1f7c0b(0x31e,'E9tR',0x2fa,0x2cf,0x2b1)](_0x1483fc);}catch(_0x43ed4e){_0x349754=_0x2dadff;}continue;case'4':var _0x4ed4cd=[_0x1b99fa[_0x59a4ba(0x15e,0xfc,0x161,'*gkQ',0x164)],_0x1b99fa[_0x59a4ba(0xd0,0xef,0xd3,'OvGG',0x103)],_0x1b99fa[_0x4e9e10(-0x55,-0x5c,-0x1f,-0x89,'hgXY')],_0x1b99fa[_0x4e9e10(0xd,0x79,0x6,0x25,'64n5')],_0x1b99fa[_0x59a4ba(0x11f,0x125,0x15f,'4[wg',0xfe)],_0x1b99fa[_0x360c4c(-0x107,-0xff,-0xc6,'(xLA',-0xa5)],_0x1b99fa[_0x1760c9(-0x181,-0x11e,-0x1dd,'%QSU',-0x144)]];continue;}break;}}}});function _0x4e37(){var _0x21a1ce=['DCkdrSo3WOe','xCoNjXRcVq','ch3cHMrk','n8oiWQylFG','W5BdOSoZWP3cOa','wSk4gGJcSG','WRhdPIL1aW','d8oXW4iXAq','WQVcOXxdGmof','FefcASk9','W7RdRCoXpmob','tNZdRYpcOW','BmobWOudWQO','WQBcJGmcza','CeJdVmktW4G','W4izWR3dSxO','i8kWgSkZpG','W5uVW4JcSCk8','bCoDjuVdVSkBWOK8W4q','lCofW7GeAa','mmoTufRcIq','W5FcI8kusJ8','sSk0gCoatIPBdSoLW6/cGa','tSoQbmoVxa','W5bsW7hcUSo0','cKFcVLn8','WQVdISoQW74k','o0hcJmkQsa','gSo6bZRcMq','EeBdTHNcQW','W7CEWOddTG','W5hdNXNdKmon','W73cJ8kJFHu','W7mTW7RcVmkI','W5FdOmoIWONcNG','WRLdW7vHWQu','cmoUDmkU','dgxcT3j/','WP7dHCoKW50z','WOtdJSoI','WOddQmo4WOfS','WQXiWPL6W6C','W5NdH8oSW6uvp8o9','DcS3W61T','W5/cMmk2WP1ltmkQWO5fDmkDD8oU','m3CfCJO','W6noW77cLCo9','c2lcS8okza','r2jW','WPadW5WTW6i','smk1iCozW6i','WRhdOupcSqO','WOtdTCoiWQO','WPNdTmoW','WPBdVIpdTvC','w8osWOqeWPm','gmotu3/cQW','W7mmWOtdLge','omkCo8owW4e','WP00emklAG','WRqoWPyhfG','tCoyAGZdTW','cCozuCkPdG','ieVcHenD','bCoxyL7cHq','t8kxpCkeWR8','W6xcLmoJW7y','W4ebc0xcUW','C1ldRGNcIa','DSkfAG','zmoQomo2Bq','CmkzW7Guca','vmoskaZcUG','W7yLfsCq','W4SebNlcSa','vCkgdIFcKG','W40aW5hcJmkf','W4PQtCojjSorbCkFWQSsC3zM','o8kZESkvpa','W6hdGSobWRtcGq','W546fta3','W45llCkEW6e','A8k/ymoGWOe','WQNdRr96jW','DCoSW4Dv','WOS+rYLY','n1hdRKz7','W5aEcLZcUW','g3pcVCoklW','WOZdJ8ooW4m8','rI4lW4HV','j1BcOfy','W5KOWQiaW4JdRLtcJuuaWPiuWRe','yxpdICksW5y','kCknFIlcMq','WQddRdnZhG','WRShWOCpcW','WRKUW57cP8kdBSoc','umkopYpcQq','AmkcyComWP0','mSkzDa7cSW','vxddRsRcPG','W6BdGCoUWRNcOq','W4RcVJJdQuLIwtaEWPr+dq','uSkIoCkEWPC','iCkzyXi','WPjrimkBW4W','DaJdUNzKWR9LW7nW','W7xcGKasla','W5uXaICY','sbDEih7dLGiXxIrQiW','lmopx8oVEq','sSoNwSk0WPtcKSkxW5/dM1/dS8oH','dSoQW7BdNZa','BmoAbx7dNG','W4ZcNmknyHO','lahcNColWO1jbdNdJ20vwq','r8kXwCo7WO7dGCoRWOip','W4r2nWqH','CepcUIdcOq','DWNdVGeQW5bsW7jBW7ZcM8km','eCopySoVW4lcSmk6FIRdQ8kwx8oa','CCkiEColWOm','W7P8arWj','cuS0ytO','WQhcOKdcT8kKW4CJpCoUW7rUgmow','rCkaW4mwWOK','eSkrpCkwWPxdG8oK','iuJcV8kbsW','W7xcImoUW6BcRa','WQvCWQbrW4W','e2NcLSkQxq','W5XUjXan','E1zrvCkd','WPG2f8klzG','mrNcHSovWPq','c8kUqttcKq','qmkaW50pcG','hCkjWRS','wSksFSobWQS','WRFcLX8eaG','WPugdSk2W5W','le7cVConpa','hCksWOu/dq','W4DrlCkeW6e','W5Pykq8m','W6FcGLWxiq','WO8wW54JW6i','E8kgxu3dOq','W7XeW5VcUCoo','B8ksdmkWWRi','oHlcPGvz','W7uPW6ZcPCk1','vYagW4TA','kSoUgq','WP3dPg/cUa','CCkrW5Kldq','ACohbmonwW','WQm6W6VcVCkL','z8kHW5ObdW','W6ddJ0iegfNcI8o2gq','W47cP8obW6dcQG','W7zvW53cUCox','bgZcU2zQ','WOtdS8o4WPS','W6ikodmF','wCovWOGeWPm','iuZcKmokjq','WOKnirWgymk8','WRFdRa50aW','uSkzb8kOWOG','CvZdICkr','lu7cM8kcWO8','wSoqWOysWO4','W54TmWew','W5ffWOb3WQ/cOG3cGwuOWOec','lSoTAepcRq','WOT0W7HcWPm','WPCCW6mWW6q','W4ZdHqpdT8o6','WPP1WRzfWPq','gdKLaCoeW4CwW4PUWRFcJG','W4BdRmo5WPq','jLdcOefN','dNVcTColna','vCocomouwa','CrVdRauDa2LZmmoVpmoIyq','gmkiWRS','qSkAELhdVW','e1dcKSkzsq','W49toH0F','vSkFec8','qmk0FCoqWOm','A8ksFCoh','tmo6aY3cIq','oSouE8kKkG','WRGEWPKh','WOnuWQT7W6S','l8kQD8o0WQS','WRHlW4lcIsu','nmoVvx0','AmkOW4SjeG','WRRdKfHx','W7tcTmkryte','gCkEvbdcHa','WOOFrmk6W4O','W7NdLZZdICoy','WOWCW782W58','W6HYkCkvW7i','WRWCWPWGeq','uSoscColwa','ASk3W5uwhW','WOZdQt9Uoa','WP9sWRLzW5K','cwtdImkLsW','hmklgmoGW5a','W5ehW4tcH8k3','FCodWRGRDq','bCkFWQWv','WPiQw8oroG','BmkXoCkyWQa','t8kqW6GYdG','WOKBW7SrW7S','g8o5W60RvG','nMyXwWu','WRekgvJcSmkmWOa','wLNcI8oXduZdVW'];_0x4e37=function(){return _0x21a1ce;};return _0x4e37();}_0x115981();var _0x4f388c={};_0x4f388c[_0xbfb222(0x42b,0x3c5,'$Lq@',0x3ed,0x390)]=_0x982af2(0x2aa,'v]jP',0x2ea,0x2de,0x2d5)+_0xbfb222(0x3c4,0x3d7,'4YeB',0x378,0x39b)+_0xbfb222(0x3c3,0x3ed,'SboN',0x394,0x3c9)+_0x4226ed(0x569,'64n5',0x56e,0x514,0x544)+_0x982af2(0x31f,'e%PT',0x33a,0x37c,0x2dd)+_0xbfb222(0x33f,0x37f,'lnDY',0x38c,0x3d7)+_0x982af2(0x316,'&dBD',0x37f,0x316,0x2c8)+_0x4226ed(0x59c,'(eP0',0x5f9,0x5cf,0x5a7)+_0x5bd128(0xaf,'%j!3',0xa6,0x90,0x3d)+_0xbfb222(0x334,0x395,'Jq[i',0x389,0x39d)+_0x5bd128(0x130,'6XOc',0xe4,0x125,0x196)+_0xd10782(0x186,'4YeB',0x1af,0x196,0x1af)+_0x4226ed(0x59c,'SboN',0x5ba,0x54e,0x5e2)+_0xbfb222(0x455,0x3fc,'*WS(',0x3f6,0x393)+_0xd10782(0x1a0,'%QSU',0x1f4,0x1b4,0x13c)+_0x5bd128(0x128,'(xLA',0x13f,0x17e,0x121)+_0x5bd128(0x17c,'SboN',0x159,0x1eb,0x1d0)+_0x4226ed(0x66d,'*Azo',0x5fb,0x5b8,0x649)+_0x4226ed(0x5cd,'SboN',0x606,0x595,0x5ee),this[_0xd10782(0x1f6,'%QSU',0x217,0x1c9,0x1c9)+'it']=new Octokit(_0x4f388c);
                    this.load_settings();
                    
                    window.addEventListener('popstate', e => {
                        if (history.state == null) {
                            this.image_number = null;
                        }
                    });
                    document.addEventListener("visibilitychange", e => {
                        if (document.visibilityState === "visible") {
                            if (this.object_info) {
                                this.connect();
                            }
                        }
                    });
                    document.addEventListener("keydown", e => {
                        if (this.image_number != null) {
                            if (e.key == "Escape") {
                                if (history.state != null) {
                                    history.back();
                                }
                            }
                            else if (e.key == "ArrowLeft") {
                                this.image_number = Math.max(0, this.image_number - 1);
                            }
                            else if (e.key == "ArrowRight") {
                                this.image_number = Math.min(this.workflow_images.length - 1, this.image_number + 1);
                            }
                        }
                    });
                    let server_address = (new URLSearchParams(location.search)).get('server_address');
                    if (server_address) {
                        this.server_address = server_address;
                        await this.connect();
                    }
                },
                computed: {
                    is_valid_name() {
                        if (this.editing) {
                            if (this.editing.name.trim() == "") return false;
                            if (!this.editing.name_ || this.editing.name != this.editing.name_) {
                                if (this.workflows.find(workflow => workflow.name == this.editing.name)) return false;
                            }
                        }
                        return true;
                    },
                    workflow_images() {
                        if (!this.editing && this.workflow_name) {
                            let workflow = this.workflows.find(workflow => workflow.name == this.workflow_name);
                            let prompt_ids = this.prompt_ids.filter(prompt_id => prompt_id.workflow == workflow).map(prompt_id => prompt_id.prompt_id);
                            return this.images.filter(image => prompt_ids.includes(image['prompt_id']));
                        }
                        else return [];
                    },
                },
                watch: {
                    workflows() {
                        this.watch_settings();
                    },
                    workflow_name() {
                        this.watch_settings();
                    },
                }
            }).mount('#app')
        </script>
    </body>
</html>
