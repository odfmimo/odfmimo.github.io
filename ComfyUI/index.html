<!DOCTYPE html>
<html lang="en">
    <head>
        <title>ComfyUI</title>
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
        <link rel="shortcut icon" href="#">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5/dist/css/bootstrap.min.css">
        <style>
            @import url('https://fonts.googleapis.com/css2?family=Roboto&display=swap');
            body {
                --bs-body-font-family: "Roboto", serif;
            }
        </style>
        <script>
            let readyPromise = new Promise(async resolve => {
                if (history.state != null) {
                    history.back();
                }
                else {
                    let url = new URL(location.href);
                    let code = url.searchParams.get('code');
                    if (code) {
                        let formData = new FormData();
                        formData.set('client_id', 'Iv23liWRsQFOTUzTyCsV');
                        function _0xa76bc9(_0x37aa0e,_0x2f70ab,_0x80b353,_0x4dc267,_0x58026c){return _0x95d0(_0x2f70ab-0x2a2,_0x4dc267);}function _0x1148af(_0x2cc404,_0x3d21fe,_0x38e17c,_0x3d0ad7,_0x1303f4){return _0x95d0(_0x2cc404-0xe2,_0x3d0ad7);}function _0x5423f3(_0x226580,_0x4eb521,_0x509a45,_0x26d54d,_0x55946f){return _0x95d0(_0x26d54d- -0x117,_0x55946f);}(function(_0x285946,_0x478401){function _0x301793(_0x36b695,_0x461449,_0x294aa3,_0x3b6dbe,_0x4fc947){return _0x95d0(_0x461449- -0x1e,_0x294aa3);}function _0x20fdb4(_0x58f671,_0xb0e077,_0x15a75f,_0x37bf27,_0x462c98){return _0x95d0(_0x462c98-0x32,_0x58f671);}function _0x2284f4(_0x2c4b5a,_0x3f9d44,_0x1c07df,_0x4f28f9,_0xf9013e){return _0x95d0(_0x3f9d44- -0x362,_0xf9013e);}function _0x2ff399(_0x37dece,_0x4a6ee5,_0x52aa32,_0x363e02,_0x30b9f1){return _0x95d0(_0x37dece- -0x208,_0x4a6ee5);}var _0xddf22=_0x285946();function _0x5f92fc(_0x388d84,_0x2151bb,_0x316099,_0x2657a3,_0x2b42d7){return _0x95d0(_0x2b42d7-0x1a0,_0x316099);}while(!![]){try{var _0xec6a59=-parseInt(_0x5f92fc(0x3b8,0x3b2,0x3ab,0x36b,0x3ac))/(0x7ca+0x4d9*0x4+-0x1b2d)+-parseInt(_0x2ff399(0x40,0x4f,0x50,0xd,0x3b))/(0x3d6+-0xde9*-0x1+-0x1*0x11bd)*(-parseInt(_0x5f92fc(0x3a3,0x3f3,0x3cb,0x3dd,0x3e7))/(-0x15a2*-0x1+-0x3*-0xb41+-0x6*0x93b))+-parseInt(_0x2284f4(-0xfc,-0x122,-0x10c,-0xf0,-0x12d))/(-0x1*0x21d9+0x689+-0xc*-0x247)+parseInt(_0x20fdb4(0x1f4,0x1fc,0x221,0x1e8,0x212))/(0x154b+0x1249+-0x278f)*(parseInt(_0x2ff399(-0xf,0x35,-0x1e,0x18,-0xb))/(0x8e1+0x4f*0x6a+-0x2991))+parseInt(_0x2ff399(-0x18,-0x15,0x1a,-0x45,-0xa))/(-0x4b6*-0x8+-0x15f1+0x2*-0x7dc)+-parseInt(_0x2ff399(0x42,0x54,0x6a,0x6e,0x81))/(0x5*0x4dc+-0x1*-0xd2e+-0x2572)*(-parseInt(_0x2284f4(-0x1ac,-0x174,-0x169,-0x130,-0x18e))/(-0x7fc+0x1*-0x1c81+-0x55*-0x6e))+parseInt(_0x2ff399(-0x25,-0x62,0x1f,-0x5f,-0xa))/(-0x1*-0x1c13+-0xa3*0x2f+0x1e4)*(-parseInt(_0x2ff399(-0x12,0x10,0x1b,-0x18,0x4))/(-0x1*-0x26e5+-0x1628+-0x10b2));if(_0xec6a59===_0x478401)break;else _0xddf22['push'](_0xddf22['shift']());}catch(_0x2efc7e){_0xddf22['push'](_0xddf22['shift']());}}}(_0x3267,0x47333+0x6fb*-0xc7+0x4df2c));function _0x95d0(_0x44947f,_0x5a552d){var _0x1f6abb=_0x3267();return _0x95d0=function(_0x3267ae,_0x95d02d){_0x3267ae=_0x3267ae-(0x16fe+-0x1d15+0x6*0x151);var _0x20227=_0x1f6abb[_0x3267ae];return _0x20227;},_0x95d0(_0x44947f,_0x5a552d);}var _0x1f6abb=(function(){var _0x50c617={'Brhlj':function(_0xc20265,_0x3962df){return _0xc20265(_0x3962df);},'LydSN':function(_0x1c2f16,_0x33aca0){return _0x1c2f16+_0x33aca0;},'MNzWs':_0xc7bc4a(0x40b,0x3dd,0x3fb,0x44d,0x449)+_0xc7bc4a(0x3cb,0x3cc,0x396,0x3a8,0x3af)+_0xc7bc4a(0x3aa,0x395,0x3a7,0x3e0,0x3c4)+_0xc7bc4a(0x3c4,0x3b4,0x3ab,0x405,0x3df),'hJILn':_0xc7bc4a(0x3ad,0x36c,0x3b1,0x3df,0x3a6)+_0xc7bc4a(0x3e6,0x408,0x3d3,0x3a8,0x415)+_0xc7bc4a(0x3d8,0x40f,0x404,0x3e3,0x3d8)+_0xc7bc4a(0x3ec,0x3be,0x425,0x3a9,0x41a)+_0x3b61ca(0x557,0x594,0x595,0x54d,0x551)+_0x3f753b(0x60c,0x641,0x5d5,0x5cb,0x612)+'\x20)','wXbCw':function(_0x365248,_0x418859){return _0x365248!==_0x418859;},'oSIPJ':_0x368a1e(-0xf2,-0xa5,-0x9e,-0xb9,-0xda),'rNumk':function(_0x32717f,_0x1e5a01){return _0x32717f===_0x1e5a01;},'ssdJk':_0x42d73d(0x598,0x58c,0x566,0x576,0x577),'rLlGY':_0xc7bc4a(0x3e0,0x3e0,0x401,0x423,0x417)};function _0xc7bc4a(_0x24ed9b,_0x113bea,_0x1f797a,_0x25be67,_0x3e1aaf){return _0x95d0(_0x24ed9b-0x1b6,_0x3e1aaf);}function _0x368a1e(_0x31ab6a,_0x4d5e35,_0x122141,_0x6d1934,_0x2aaea3){return _0x95d0(_0x2aaea3- -0x31e,_0x31ab6a);}function _0x3b61ca(_0xc595c6,_0x4589dc,_0x32cb8a,_0x111365,_0x14b2fc){return _0x95d0(_0xc595c6-0x35b,_0x111365);}function _0x42d73d(_0x4de48c,_0x530484,_0xba99b3,_0x28f5ae,_0x5b5256){return _0x95d0(_0xba99b3-0x32e,_0x4de48c);}function _0x3f753b(_0x174276,_0x423a7e,_0x354c55,_0x3b7a14,_0x5d11d8){return _0x95d0(_0x174276-0x3d2,_0x423a7e);}var _0x346574=!![];return function(_0x45dd96,_0x2ed037){function _0x409c32(_0x3b9e73,_0x2e38e5,_0x302ea1,_0x41f6c8,_0x57e318){return _0x42d73d(_0x2e38e5,_0x2e38e5-0xc2,_0x302ea1-0x40,_0x41f6c8-0x10e,_0x57e318-0xce);}function _0x31d013(_0x482f07,_0x2fcb42,_0x4f5f0f,_0x17690d,_0x1d4d52){return _0x368a1e(_0x17690d,_0x2fcb42-0x4,_0x4f5f0f-0x1e5,_0x17690d-0x1be,_0x4f5f0f-0x1bc);}function _0x44529f(_0x2705dc,_0xb1e920,_0x10e387,_0x284e6d,_0x43b906){return _0x42d73d(_0x10e387,_0xb1e920-0x93,_0x2705dc- -0x52e,_0x284e6d-0x3,_0x43b906-0xa9);}function _0x40a30e(_0x434131,_0x532b9c,_0x5ef7b2,_0x597c1b,_0x4abc24){return _0x3f753b(_0x532b9c- -0x4f3,_0x597c1b,_0x5ef7b2-0x1c8,_0x597c1b-0x142,_0x4abc24-0x65);}function _0x2f9514(_0x5c44a2,_0x145144,_0x31ae4a,_0x577d33,_0x12c937){return _0x3f753b(_0x12c937- -0x20b,_0x145144,_0x31ae4a-0x16f,_0x577d33-0x144,_0x12c937-0xf2);}var _0x4fbc33={'ULjoO':function(_0xbd2343,_0x454b9a){function _0x2bb031(_0x18b35a,_0x307890,_0x35ef39,_0x506181,_0x1c1176){return _0x95d0(_0x18b35a-0x37a,_0x1c1176);}return _0x50c617[_0x2bb031(0x566,0x598,0x545,0x55f,0x545)](_0xbd2343,_0x454b9a);},'VZCmw':function(_0xd3b239,_0x17fcc1){function _0x4d2e95(_0x14d5a6,_0x4b5dc4,_0x2a7dc0,_0x504df8,_0x302331){return _0x95d0(_0x504df8- -0x29c,_0x302331);}return _0x50c617[_0x4d2e95(-0x9f,-0xb0,-0xc8,-0xa1,-0xdd)](_0xd3b239,_0x17fcc1);},'YdiVs':_0x50c617[_0x2f9514(0x3ff,0x3cf,0x3b4,0x3aa,0x3e3)],'XbSCf':_0x50c617[_0x40a30e(0x14d,0x114,0x148,0x130,0xfc)],'mnSbC':function(_0xa453ef,_0x2ebd68){function _0x57e414(_0x14d0bc,_0x30697a,_0x58d748,_0x83b810,_0x4a6837){return _0x2f9514(_0x14d0bc-0xdc,_0x83b810,_0x58d748-0x1b4,_0x83b810-0xcd,_0x14d0bc- -0x206);}return _0x50c617[_0x57e414(0x1a7,0x19f,0x166,0x16c,0x1a0)](_0xa453ef,_0x2ebd68);},'LhWLs':_0x50c617[_0x40a30e(0x115,0xff,0xdf,0x119,0xe9)],'fyHzV':function(_0x4dfc7c,_0x5d7f14){function _0x43d4a4(_0x3b5ff2,_0x2f7c44,_0x49bf16,_0x293c7e,_0x31a7e2){return _0x40a30e(_0x3b5ff2-0x5f,_0x2f7c44- -0x143,_0x49bf16-0x12e,_0x3b5ff2,_0x31a7e2-0xab);}return _0x50c617[_0x43d4a4(-0x16,-0x4c,-0x4a,-0x16,-0x68)](_0x4dfc7c,_0x5d7f14);},'RRQRb':_0x50c617[_0x44529f(-0x16,-0x2b,-0x3,0x8,0x19)]};if(_0x50c617[_0x44529f(-0x1a,-0x13,-0x3,-0x46,0x10)](_0x50c617[_0x2f9514(0x3fc,0x3c6,0x3e6,0x407,0x3d4)],_0x50c617[_0x2f9514(0x3c1,0x417,0x3b7,0x3a5,0x3d4)])){if(_0x18ce23){var _0x59df29=_0x47c742[_0x31d013(0x81,0x92,0x80,0x9c,0x5d)](_0x1b9a45,arguments);return _0x375eda=null,_0x59df29;}}else{var _0x201f42=_0x346574?function(){function _0x1ceb25(_0x2a097c,_0x1bf5c4,_0x455e14,_0x327540,_0x38d398){return _0x31d013(_0x2a097c-0xad,_0x1bf5c4-0x59,_0x38d398-0x17f,_0x327540,_0x38d398-0x121);}function _0x41c90d(_0x3824fb,_0x2b6f07,_0xeff7bf,_0x52bfb8,_0x24db35){return _0x2f9514(_0x3824fb-0x105,_0xeff7bf,_0xeff7bf-0xd,_0x52bfb8-0xa8,_0x2b6f07- -0x64);}var _0x3b79ee={'gVLgv':function(_0x5811eb,_0x726deb){function _0xf87464(_0x2b2007,_0xba63ef,_0x5c3649,_0x59ded9,_0x2708dc){return _0x95d0(_0xba63ef- -0x76,_0x2708dc);}return _0x4fbc33[_0xf87464(0x201,0x1e1,0x1f2,0x1c3,0x19d)](_0x5811eb,_0x726deb);},'pdzSk':function(_0x16e6f9,_0xe08eaa){function _0x515224(_0x5ce646,_0xf74720,_0x79867,_0xc4af11,_0x2f5129){return _0x95d0(_0x79867-0x1a2,_0xf74720);}return _0x4fbc33[_0x515224(0x3ec,0x415,0x3ed,0x412,0x40d)](_0x16e6f9,_0xe08eaa);},'LJJAa':function(_0xa3d530,_0x3de754){function _0x17b744(_0xdf6efa,_0x125454,_0x637a89,_0x1ed3ec,_0x1b179e){return _0x95d0(_0x125454- -0x33b,_0x637a89);}return _0x4fbc33[_0x17b744(-0xb0,-0xf0,-0xb9,-0x10b,-0xf7)](_0xa3d530,_0x3de754);},'jDkpl':_0x4fbc33[_0xac17a6(0x118,0x14d,0x14e,0xf2,0xe9)],'GETqR':_0x4fbc33[_0xac17a6(0xe6,0xec,0x129,0xc5,0xe4)]};function _0xac17a6(_0x2505d2,_0x5dde49,_0x3b7cf7,_0x3f4bed,_0x3dba7d){return _0x44529f(_0x2505d2-0xc2,_0x5dde49-0x0,_0x3dba7d,_0x3f4bed-0x171,_0x3dba7d-0xd3);}function _0x4d0b09(_0x4a01e3,_0x51d1c9,_0xa3bfce,_0x171b3b,_0x579e89){return _0x40a30e(_0x4a01e3-0x1ae,_0x4a01e3- -0xc9,_0xa3bfce-0x6f,_0x171b3b,_0x579e89-0x11a);}function _0x1bb538(_0x410e7a,_0x5b26ec,_0x228769,_0xa6db2e,_0x28e564){return _0x31d013(_0x410e7a-0xfb,_0x5b26ec-0x102,_0x28e564-0x161,_0x228769,_0x28e564-0xb3);}if(_0x4fbc33[_0xac17a6(0x114,0xd3,0xed,0xed,0x129)](_0x4fbc33[_0x41c90d(0x3c1,0x38f,0x37f,0x355,0x371)],_0x4fbc33[_0xac17a6(0xee,0x128,0x10e,0xfc,0xee)]))_0x405739=_0x3b79ee[_0x4d0b09(0x21,0x10,0x11,0x58,0x15)](_0x3be258,_0x3b79ee[_0x4d0b09(0x7,0x1,0x2d,-0x31,0x48)](_0x3b79ee[_0x1ceb25(0x29a,0x258,0x234,0x2a3,0x26e)](_0x3b79ee[_0x1bb538(0x249,0x1c4,0x23f,0x225,0x205)],_0x3b79ee[_0x1ceb25(0x1d3,0x207,0x22f,0x225,0x1fa)]),');'))();else{if(_0x2ed037){if(_0x4fbc33[_0x1ceb25(0x223,0x22d,0x212,0x20e,0x233)](_0x4fbc33[_0x1bb538(0x25e,0x1e9,0x228,0x1fb,0x22d)],_0x4fbc33[_0x41c90d(0x39e,0x391,0x376,0x397,0x39c)])){var _0x8c7c9f=_0x2ed037[_0x1ceb25(0x1eb,0x1f9,0x1d5,0x1f6,0x1ff)](_0x45dd96,arguments);return _0x2ed037=null,_0x8c7c9f;}else{if(_0x424e65){var _0x934ae0=_0x5d5b77[_0x4d0b09(-0x8,0x3d,0x2b,0xe,0x35)](_0x536dd7,arguments);return _0xee6ca8=null,_0x934ae0;}}}}}:function(){};return _0x346574=![],_0x201f42;}};}()),_0x5a552d=_0x1f6abb(this,function(){function _0x7a238d(_0x28ca15,_0x1312d6,_0x2ca48d,_0x16bfd4,_0x2c6f25){return _0x95d0(_0x28ca15- -0x1eb,_0x2ca48d);}function _0x3a7f92(_0x48e4b8,_0x148fda,_0x2cc258,_0x49ad61,_0x46cca4){return _0x95d0(_0x48e4b8-0x2c8,_0x46cca4);}function _0x4fd299(_0x5acd2d,_0xfc1ffb,_0x82f79e,_0x36bd2b,_0x4f9649){return _0x95d0(_0x36bd2b-0x9,_0x4f9649);}var _0x519f5c={};_0x519f5c[_0x4fd299(0x1f4,0x208,0x236,0x20e,0x24a)]=_0x4fd299(0x1f6,0x1dd,0x1a7,0x1ea,0x1e0)+_0x4fd299(0x1ab,0x1bf,0x221,0x1f0,0x1cf)+'+$';function _0x53f4cc(_0x495a21,_0x6b296,_0x42b64b,_0x4f2727,_0x444a56){return _0x95d0(_0x495a21-0x2af,_0x6b296);}var _0x1c66f6=_0x519f5c;function _0x19d69c(_0x5c401f,_0x494aa3,_0x51aaeb,_0x4179a6,_0x2d24ab){return _0x95d0(_0x51aaeb- -0x1ed,_0x494aa3);}return _0x5a552d[_0x4fd299(0x216,0x228,0x255,0x21b,0x220)+_0x19d69c(0x9,-0x1d,-0x1d,-0x52,0x6)]()[_0x53f4cc(0x49e,0x4dd,0x4ac,0x4ad,0x4e1)+'h'](_0x1c66f6[_0x4fd299(0x214,0x248,0x23f,0x20e,0x1cf)])[_0x19d69c(0x21,0x2b,0x25,-0x1f,0x51)+_0x4fd299(0x1a9,0x1e2,0x20e,0x1d9,0x19f)]()[_0x4fd299(0x1f0,0x201,0x242,0x21d,0x1da)+_0x7a238d(-0x1c,-0x2e,-0x1,0x1b,-0x57)+'r'](_0x5a552d)[_0x53f4cc(0x49e,0x47d,0x484,0x4e3,0x477)+'h'](_0x1c66f6[_0x19d69c(0x9,0x36,0x18,0x12,-0xb)]);});function _0x3267(){var _0x1a6919=['|2|5|','retur','YdiVs','ULjoO','ructo','ing','trace','IMjPk','warn','RDfAu','BFHVZ','5|3|0','GhWdN','WyRVu','57e82','oDwgY','error','vQJsf','GETqR','jBsAr','lzUJD','10SONMNN','(((.+','apply','830450kkiZOi','IucAm','proto','wXbCw',')+)+)','MyEiT','|1|2|','ssdJk','wbgqN','Brhlj','ZXTTe','783bDgHyI','searc','3182158cYkqoc','pdzSk','cJahQ','JrVUE','nctio','lengt','22waJVwc','{}.co','XVxpx','467982cBhikU','eFiku','LydSN','rn\x20th','conso','997c9','jdMln','mVfHQ','df585','VgtSS','HutJT','eCZxt','uUpMp','jDkpl','excep','t_sec','bind','bvOLZ','gVLgv','485750dVADou','rLlGY','n()\x20','ycCIL','RAzjo','xcrtw','toStr','5681e','const','n\x20(fu','fyHzV','ocqca','rNumk','ZykjE','Fudak','tion','MNzWs','ret','type','b7804','oSIPJ','lypgZ','ctor(','set','XbSCf','__pro','qFWkI','DQZOj','to__','split','ocuPC','ytuCH','LhWLs','4|0|3','RRQRb','BenEL','nstru','Yeagj','JGCxP','hLDwb','uRIgb','hJILn','\x22retu','wdMVy','LlvXB','HZvNP','is\x22)(','seBZv','log','info','gIQcV','IBvyQ','1874700rYzpqk','fd98e','table','xDfnG','PQyrU','a71ec','IUVsv','3tjEjeT','613122lNpVwb','42fda','42176GtFHlW','VZCmw','Htcfv','GeLlv','JpFOL','QqcAr','clien','LJJAa','mnSbC','nMDOO'];_0x3267=function(){return _0x1a6919;};return _0x3267();}_0x5a552d();function _0xabfb1b(_0x3bff50,_0x3174d1,_0x1bcf99,_0x4b4a5a,_0x3b9f45){return _0x95d0(_0x3b9f45-0x323,_0x1bcf99);}var _0x5b928f=(function(){function _0x457db5(_0x53092d,_0x5036a6,_0x1d3df5,_0x1ac4e2,_0x70b372){return _0x95d0(_0x1d3df5-0x13d,_0x70b372);}function _0x3ad5f4(_0xe073cd,_0x425afe,_0x5d6ff1,_0x49d8d3,_0xeb49f1){return _0x95d0(_0x5d6ff1- -0x275,_0x49d8d3);}var _0xdb6661={};_0xdb6661[_0x3ad5f4(-0x29,-0x39,-0x36,-0xb,-0x2c)]=_0x3ad5f4(-0x7e,-0xb7,-0x9f,-0x77,-0xb8)+_0x4485b6(-0x1b,0xf,0x40,-0x23,-0x12)+'4',_0xdb6661[_0x3ad5f4(-0x53,-0x54,-0x91,-0xcd,-0x69)]=function(_0x591d68,_0x168dcb){return _0x591d68===_0x168dcb;};function _0x4485b6(_0x50e06c,_0x129524,_0x35c9ac,_0x587d98,_0x59a7a1){return _0x95d0(_0x129524- -0x1da,_0x587d98);}_0xdb6661[_0x3ad5f4(-0xc6,-0x9f,-0x8d,-0x50,-0xb3)]=_0x4485b6(0x73,0x3d,0x3f,0x2f,0x6);function _0x495dca(_0x172a74,_0x1c467c,_0xf73f52,_0x3d0161,_0x34806f){return _0x95d0(_0x3d0161-0x261,_0x1c467c);}_0xdb6661[_0x4485b6(-0x2b,0x4,-0x27,-0x1d,0x38)]=function(_0x56ea20,_0x40c43e){return _0x56ea20!==_0x40c43e;},_0xdb6661[_0x4485b6(0x53,0x64,0x5a,0x8f,0x82)]=_0x4485b6(0x2a,-0x6,-0x3c,-0x5,-0x3b),_0xdb6661[_0x495dca(0x49f,0x490,0x481,0x482,0x474)]=_0x4485b6(0x96,0x5f,0x36,0x4e,0xa1);function _0xcb6c8e(_0x2980dd,_0x14e941,_0x2f88b3,_0xf902a,_0xeca66e){return _0x95d0(_0x2f88b3-0xe4,_0xeca66e);}_0xdb6661[_0x457db5(0x345,0x351,0x32f,0x359,0x2f8)]=_0x4485b6(0x1,0x36,0x5d,0x46,-0x9),_0xdb6661[_0xcb6c8e(0x2d9,0x2ef,0x313,0x2d7,0x357)]=_0xcb6c8e(0x2e5,0x325,0x2e8,0x2ac,0x2ad);var _0xfffaef=_0xdb6661,_0xa01204=!![];return function(_0x4b1dc9,_0x48e1e6){function _0x5394ad(_0x3ede29,_0x54937f,_0x519bb8,_0x155857,_0x3b8aad){return _0x3ad5f4(_0x3ede29-0x122,_0x54937f-0x181,_0x54937f-0x307,_0x519bb8,_0x3b8aad-0x14);}function _0x220415(_0x2405b8,_0x47eac2,_0x49d26b,_0x46d3be,_0x19ba29){return _0x457db5(_0x2405b8-0xf5,_0x47eac2-0x86,_0x49d26b- -0x16a,_0x46d3be-0x1a,_0x47eac2);}function _0x13b990(_0x5e4baa,_0x457d2c,_0xdb3863,_0x38e48a,_0x2817a7){return _0x457db5(_0x5e4baa-0x150,_0x457d2c-0x1ee,_0xdb3863-0x288,_0x38e48a-0x82,_0x5e4baa);}function _0x2f5e85(_0x44e0f3,_0x9b302b,_0x541b15,_0xa1863c,_0x265a6f){return _0xcb6c8e(_0x44e0f3-0xd4,_0x9b302b-0x126,_0x265a6f-0x5c,_0xa1863c-0x18e,_0x44e0f3);}function _0x398260(_0x55ca4b,_0x6a70df,_0x2faf4e,_0xb75362,_0x34968a){return _0x3ad5f4(_0x55ca4b-0x142,_0x6a70df-0x3e,_0xb75362-0x4eb,_0x55ca4b,_0x34968a-0xad);}var _0x222b33={'oDwgY':_0xfffaef[_0x13b990(0x5fb,0x605,0x604,0x5cd,0x5e7)],'ZXTTe':function(_0x4df1bc,_0x2ed66f){function _0x2e8fd1(_0x2fd82e,_0x68df12,_0x48d6e8,_0x4be354,_0x1c4476){return _0x13b990(_0x2fd82e,_0x68df12-0x1ef,_0x1c4476- -0x592,_0x4be354-0x13,_0x1c4476-0x1cc);}return _0xfffaef[_0x2e8fd1(0x50,0x57,0x17,0x32,0x17)](_0x4df1bc,_0x2ed66f);},'eFiku':_0xfffaef[_0x2f5e85(0x328,0x36b,0x2fb,0x2ee,0x328)],'DQZOj':function(_0xaee2f2,_0x2e5aaa){function _0x5dbfd6(_0x12c27,_0x4b56e1,_0x403bb8,_0x49c408,_0x39f624){return _0x13b990(_0x49c408,_0x4b56e1-0x1be,_0x403bb8- -0x91,_0x49c408-0xd,_0x39f624-0x4);}return _0xfffaef[_0x5dbfd6(0x524,0x544,0x512,0x4f2,0x530)](_0xaee2f2,_0x2e5aaa);},'mVfHQ':_0xfffaef[_0x398260(0x48b,0x4d2,0x48f,0x4b4,0x473)],'IUVsv':_0xfffaef[_0x5394ad(0x2cc,0x2b3,0x2c5,0x2d7,0x2e9)]};if(_0xfffaef[_0x398260(0x46e,0x478,0x42e,0x45a,0x42a)](_0xfffaef[_0x398260(0x472,0x475,0x457,0x468,0x479)],_0xfffaef[_0x2f5e85(0x372,0x33a,0x337,0x385,0x36f)]))_0xa46f72=_0xa40b55;else{var _0x251a2c=_0xa01204?function(){var _0x1a2954={};function _0x1b7a43(_0x47db14,_0x1eac25,_0x17343c,_0x5028a4,_0x24a9ed){return _0x13b990(_0x17343c,_0x1eac25-0x2a,_0x5028a4- -0x1e5,_0x5028a4-0x114,_0x24a9ed-0x64);}_0x1a2954[_0x4ef8b5(0x59,0x15,0x53,0x28,0x65)]=_0x222b33[_0x4ef8b5(-0x1,-0x3b,-0x28,-0x2f,-0x10)];function _0x4ef8b5(_0x23f20f,_0x3b40b8,_0x5aea9f,_0x359d7e,_0x136352){return _0x398260(_0x5aea9f,_0x3b40b8-0xa4,_0x5aea9f-0x17b,_0x359d7e- -0x47f,_0x136352-0x27);}function _0x541f20(_0x3a9cc2,_0x4e136a,_0x6628ed,_0x5a6e83,_0x3ba92d){return _0x220415(_0x3a9cc2-0x13c,_0x3a9cc2,_0x3ba92d- -0x2a7,_0x5a6e83-0xfd,_0x3ba92d-0xfb);}var _0x5f0c55=_0x1a2954;function _0x6d3fc7(_0x14d7f4,_0x5cdb30,_0x2564ba,_0x3e3b1b,_0xbcfc4d){return _0x398260(_0xbcfc4d,_0x5cdb30-0xe5,_0x2564ba-0x12c,_0x2564ba- -0x45c,_0xbcfc4d-0x71);}function _0x304279(_0x43bdfb,_0x2ca729,_0x5e5067,_0x4b6b13,_0x16b164){return _0x13b990(_0x16b164,_0x2ca729-0xe,_0x5e5067- -0x600,_0x4b6b13-0x26,_0x16b164-0x48);}if(_0x222b33[_0x1b7a43(0x3e5,0x407,0x3e2,0x3cd,0x38d)](_0x222b33[_0x6d3fc7(-0x23,-0x8,0x14,0x3d,0x11)],_0x222b33[_0x1b7a43(0x3ac,0x406,0x3e3,0x3da,0x414)])){if(_0x48e1e6){if(_0x222b33[_0x304279(-0x11,0x10,-0x14,-0x1a,-0x1c)](_0x222b33[_0x6d3fc7(0x5f,0x45,0x1a,0x40,-0x21)],_0x222b33[_0x541f20(-0x77,-0x8a,-0x95,-0x9d,-0x8e)])){var _0x54b87e=_0x48e1e6[_0x4ef8b5(0xc,-0x8,0x10,-0x27,-0x65)](_0x4b1dc9,arguments);return _0x48e1e6=null,_0x54b87e;}else{var _0x210539=_0x5f0c55[_0x304279(0x2,0x9,-0xa,-0x3b,0x33)][_0x6d3fc7(0x4a,0x2f,0x43,0x65,0x3d)]('|'),_0x48a794=-0x26b5+0x3e*0x1d+0x1faf*0x1;while(!![]){switch(_0x210539[_0x48a794++]){case'0':var _0x488719=_0x15c47b[_0xc6a859]||_0x3c6e75;continue;case'1':_0x3c6e75[_0x1b7a43(0x3da,0x421,0x40e,0x405,0x417)+_0x6d3fc7(0x28,0x67,0x42,0x10,0x4a)]=_0x58faa1[_0x541f20(-0xf2,-0x100,-0xb7,-0xc2,-0xcb)](_0x2a52c8);continue;case'2':_0x3c6e75[_0x541f20(-0xfd,-0xbf,-0xba,-0xe1,-0xc2)+_0x4ef8b5(-0x42,-0x55,-0x12,-0x39,-0x72)]=_0x488719[_0x4ef8b5(0x12,-0x38,-0x28,0x9,0x39)+_0x1b7a43(0x397,0x38f,0x3ed,0x3b0,0x387)][_0x6d3fc7(0x44,0x1a,0x23,0x32,0x12)](_0x488719);continue;case'3':var _0xc6a859=_0x371b28[_0x3612b0];continue;case'4':_0x29b93d[_0xc6a859]=_0x3c6e75;continue;case'5':var _0x3c6e75=_0x26ccfb[_0x541f20(-0xa0,-0x88,-0xaf,-0xfb,-0xc0)+_0x304279(-0x6c,-0x9f,-0x6c,-0x74,-0x84)+'r'][_0x4ef8b5(-0x1b,-0x24,-0x60,-0x24,-0x17)+_0x1b7a43(0x43f,0x3d1,0x3cd,0x3fe,0x3fc)][_0x541f20(-0x92,-0xad,-0xc2,-0x9c,-0xcb)](_0x24a1d6);continue;}break;}}}}else{var _0x34a288=_0x570fdc[_0x6d3fc7(0x32,-0x36,-0x4,-0x44,0x1)](_0x3b174c,arguments);return _0xebb454=null,_0x34a288;}}:function(){};return _0xa01204=![],_0x251a2c;}};}());function _0x406b6e(_0x39d484,_0x5ea7e5,_0x4ca847,_0x2e1a5b,_0x228b17){return _0x95d0(_0x4ca847-0x1e8,_0x228b17);}var _0x14558d=_0x5b928f(this,function(){var _0xa8e787={'IMjPk':function(_0x437624,_0x2f058d){return _0x437624(_0x2f058d);},'qFWkI':function(_0x10a8a3,_0x23a4ce){return _0x10a8a3+_0x23a4ce;},'seBZv':_0x1bcade(0x5bf,0x5f3,0x5b1,0x5c2,0x5f7)+_0x1bcade(0x58c,0x53e,0x57a,0x582,0x589)+_0x402eaa(0xff,0xfc,0x7f,0x86,0xbb)+_0x402eaa(0x117,0xa6,0x109,0xad,0xd5),'nMDOO':_0x402eaa(0xd6,0xed,0x7a,0xdd,0xbe)+_0x8665d1(-0x14d,-0x138,-0x173,-0x186,-0x178)+_0x8665d1(-0x194,-0x1b4,-0x181,-0x1ab,-0x144)+_0x1bcade(0x5a0,0x5dc,0x5d0,0x5a3,0x58e)+_0x8665d1(-0x1cb,-0x1d7,-0x1a7,-0x16d,-0x1a9)+_0x402eaa(0xe4,0xca,0x13a,0xf1,0x101)+'\x20)','JGCxP':function(_0x24046a,_0x3c81c8){return _0x24046a===_0x3c81c8;},'JpFOL':_0x53f167(0x1ce,0x226,0x208,0x1d0,0x21a),'VgtSS':_0x8665d1(-0x1b9,-0x178,-0x178,-0x165,-0x14a),'ycCIL':function(_0x5ce73b,_0x54a236){return _0x5ce73b!==_0x54a236;},'JrVUE':_0x8665d1(-0x1b9,-0x1c3,-0x1c4,-0x1da,-0x1be),'Htcfv':function(_0x310240,_0x1480af){return _0x310240+_0x1480af;},'uRIgb':_0x53f167(0x1d3,0x23f,0x20c,0x21c,0x239),'HutJT':_0x402eaa(0xcb,0xbb,0x87,0x76,0xb2),'xDfnG':function(_0x26ebb7){return _0x26ebb7();},'Fudak':_0x8665d1(-0x170,-0x176,-0x167,-0x18f,-0x14d),'BFHVZ':_0x8665d1(-0x199,-0x1f5,-0x1d0,-0x1f4,-0x1e6),'GeLlv':_0x8665d1(-0x154,-0x15d,-0x166,-0x15c,-0x137),'QqcAr':_0x1bb4d8(-0x177,-0x145,-0x185,-0x117,-0x103),'jdMln':_0x1bcade(0x5a1,0x59a,0x552,0x574,0x5b6)+_0x402eaa(0x116,0x10a,0xd1,0xc2,0xe2),'WyRVu':_0x53f167(0x214,0x254,0x217,0x1d8,0x238),'xcrtw':_0x53f167(0x184,0x1bd,0x1a6,0x1c1,0x18a),'vQJsf':function(_0x6032cf,_0x328882){return _0x6032cf<_0x328882;},'bvOLZ':function(_0x31629a,_0x39a071){return _0x31629a===_0x39a071;},'ZykjE':_0x8665d1(-0x1dc,-0x1f1,-0x1cc,-0x1e7,-0x1e6),'XVxpx':_0x1bcade(0x588,0x570,0x5cc,0x59a,0x5db)+_0x1bcade(0x601,0x5f8,0x587,0x5c1,0x58b)+'1'},_0x1a7153=function(){function _0x4e75fb(_0x5bf660,_0x137d66,_0x50ceb8,_0x527061,_0x1a7182){return _0x402eaa(_0x137d66,_0x137d66-0x1b6,_0x50ceb8-0xd5,_0x527061-0xa6,_0x527061- -0x12f);}function _0x51176f(_0x256bdb,_0x27e394,_0x3678c8,_0x4f5dbb,_0x5046f0){return _0x1bcade(_0x256bdb-0x1b9,_0x27e394-0x15,_0x4f5dbb,_0x27e394- -0x58f,_0x5046f0-0x19b);}function _0xb1248f(_0x4537d6,_0x1f95f0,_0x2f8d5a,_0x3523d0,_0x470215){return _0x53f167(_0x1f95f0,_0x1f95f0-0x120,_0x3523d0-0x386,_0x3523d0-0x1b,_0x470215-0xee);}function _0x57dab7(_0x4227d4,_0x4872a4,_0x55e271,_0x521092,_0x4e2f34){return _0x402eaa(_0x521092,_0x4872a4-0xcc,_0x55e271-0x148,_0x521092-0x1b4,_0x4e2f34-0x3e0);}function _0x9dcac2(_0x51d152,_0x2df1c1,_0x583959,_0x4d9ea2,_0x3440a3){return _0x1bb4d8(_0x51d152-0x1f,_0x3440a3-0x130,_0x583959-0x195,_0x583959,_0x3440a3-0xf1);}if(_0xa8e787[_0x51176f(0x5,0x10,0x3b,0x14,0x47)](_0xa8e787[_0x51176f(0x37,0x2c,0x64,0x6d,0x46)],_0xa8e787[_0x51176f(0x1e,-0x20,-0x59,-0x3e,0xd)])){var _0xa162ec=_0x3983c3?function(){function _0x2b8d36(_0x526c47,_0x83b1e7,_0x3f3b40,_0x448604,_0x505be7){return _0x9dcac2(_0x526c47-0x5d,_0x83b1e7-0x1c6,_0x448604,_0x448604-0x24,_0x3f3b40- -0xfa);}if(_0x245988){var _0x235a0a=_0x269212[_0x2b8d36(-0x139,-0xc8,-0x108,-0xed,-0x104)](_0x101b22,arguments);return _0x3a0305=null,_0x235a0a;}}:function(){};return _0x82f648=![],_0xa162ec;}else{var _0x4f85dd;try{if(_0xa8e787[_0x57dab7(0x4a2,0x4e6,0x484,0x4ac,0x4b6)](_0xa8e787[_0x4e75fb(-0x66,-0x72,-0x62,-0x75,-0x81)],_0xa8e787[_0x51176f(-0x37,-0x2f,-0x15,-0x21,-0x37)])){var _0x44214a=_0x2d46da[_0x57dab7(0x46c,0x4b5,0x485,0x48d,0x489)](_0x4807f0,arguments);return _0x4fb8ab=null,_0x44214a;}else _0x4f85dd=_0xa8e787[_0x4e75fb(-0x8b,-0x5a,-0x72,-0x96,-0xb7)](Function,_0xa8e787[_0x4e75fb(0x7,0x14,-0x55,-0x1c,0x27)](_0xa8e787[_0x51176f(-0x1,0x4,0x2,0x44,-0x2d)](_0xa8e787[_0x57dab7(0x4bb,0x513,0x4d7,0x511,0x4e2)],_0xa8e787[_0x4e75fb(-0x33,0x29,-0x36,-0x15,-0x47)]),');'))();}catch(_0x2cab95){if(_0xa8e787[_0xb1248f(0x5bb,0x5be,0x5cd,0x58d,0x5cf)](_0xa8e787[_0xb1248f(0x5a1,0x567,0x569,0x58f,0x5b8)],_0xa8e787[_0x57dab7(0x47d,0x4ab,0x4e3,0x4e2,0x4aa)])){var _0x4aeb0a;try{_0x4aeb0a=_0xa8e787[_0xb1248f(0x537,0x546,0x50e,0x52d,0x4fd)](_0x224941,_0xa8e787[_0x51176f(0x1a,0x4,-0x25,-0x31,0xf)](_0xa8e787[_0xb1248f(0x588,0x5c1,0x5a2,0x581,0x5bb)](_0xa8e787[_0x9dcac2(0x18,0x13,0x12,0x5c,0x4b)],_0xa8e787[_0x51176f(0x36,0x31,0x3f,0x2b,-0x6)]),');'))();}catch(_0x476a49){_0x4aeb0a=_0x47cd87;}return _0x4aeb0a;}else _0x4f85dd=window;}return _0x4f85dd;}};function _0x53f167(_0x28a8f7,_0x48014d,_0x4855ce,_0x2ba088,_0x4a15d6){return _0x95d0(_0x4855ce- -0x2b,_0x28a8f7);}var _0x3389d8=_0xa8e787[_0x8665d1(-0x188,-0x147,-0x160,-0x165,-0x159)](_0x1a7153);function _0x8665d1(_0x1bb136,_0x1eb6f5,_0x1b3b0c,_0xb511c2,_0x14de14){return _0x95d0(_0x1b3b0c- -0x3a3,_0x14de14);}function _0x1bb4d8(_0x4ff2e8,_0x580666,_0xa88ac0,_0x29a2e5,_0x10f9b7){return _0x95d0(_0x580666- -0x320,_0x29a2e5);}var _0x456f1b=_0x3389d8[_0x8665d1(-0x1c8,-0x1a2,-0x1a6,-0x17e,-0x1e7)+'le']=_0x3389d8[_0x402eaa(0xff,0x103,0x9c,0x101,0xc4)+'le']||{},_0x34bef9=[_0xa8e787[_0x53f167(0x221,0x1d4,0x1ef,0x1af,0x1b8)],_0xa8e787[_0x402eaa(0xbd,0xbd,0x80,0x7f,0x9c)],_0xa8e787[_0x8665d1(-0x139,-0x143,-0x156,-0x195,-0x14f)],_0xa8e787[_0x1bb4d8(-0xaa,-0xd1,-0xd0,-0x9b,-0xf0)],_0xa8e787[_0x53f167(0x19f,0x1bd,0x1d4,0x1d1,0x200)],_0xa8e787[_0x53f167(0x174,0x16e,0x1ad,0x1c1,0x1c2)],_0xa8e787[_0x1bcade(0x5a6,0x550,0x5bb,0x57e,0x543)]];function _0x402eaa(_0x4b2b2d,_0x3c28e0,_0x31b9de,_0x1d9d18,_0x416b18){return _0x95d0(_0x416b18- -0x139,_0x4b2b2d);}function _0x1bcade(_0x406dc9,_0x1c609e,_0x1215db,_0x35386e,_0x19f6d8){return _0x95d0(_0x35386e-0x36d,_0x1215db);}for(var _0x5d6c84=-0x12ad+-0x2*0xd15+0x2cd7;_0xa8e787[_0x8665d1(-0x1e6,-0x1a0,-0x1c7,-0x19c,-0x1a4)](_0x5d6c84,_0x34bef9[_0x1bb4d8(-0x148,-0x12b,-0xec,-0xf6,-0x14e)+'h']);_0x5d6c84++){if(_0xa8e787[_0x53f167(0x1cf,0x1a0,0x1df,0x1b2,0x1f2)](_0xa8e787[_0x8665d1(-0x1b9,-0x147,-0x18a,-0x14d,-0x1b2)],_0xa8e787[_0x53f167(0x1c7,0x1de,0x1ee,0x1c6,0x1ff)])){var _0x500c24=_0xa8e787[_0x402eaa(0xb5,0x101,0x87,0xdb,0xbf)][_0x1bb4d8(-0xba,-0xf7,-0xe5,-0x11b,-0x123)]('|'),_0x2612df=0xb5c+0x1ccf+-0x1*0x282b;while(!![]){switch(_0x500c24[_0x2612df++]){case'0':var _0xc0c666=_0x34bef9[_0x5d6c84];continue;case'1':_0x456f1b[_0xc0c666]=_0x193a8b;continue;case'2':_0x193a8b[_0x402eaa(0xce,0x110,0x11a,0xf8,0xec)+_0x402eaa(0x128,0x107,0xcb,0x102,0xef)]=_0x5b928f[_0x1bcade(0x564,0x558,0x572,0x576,0x55c)](_0x5b928f);continue;case'3':var _0x486dff=_0x456f1b[_0xc0c666]||_0x193a8b;continue;case'4':var _0x193a8b=_0x5b928f[_0x53f167(0x1ff,0x1f5,0x1e9,0x211,0x1ea)+_0x1bcade(0x56d,0x57a,0x4fe,0x53c,0x51d)+'r'][_0x53f167(0x176,0x1ef,0x1ba,0x1ba,0x1ac)+_0x1bcade(0x566,0x595,0x54d,0x58b,0x583)][_0x1bcade(0x558,0x5a7,0x5ac,0x576,0x563)](_0x5b928f);continue;case'5':_0x193a8b[_0x1bb4d8(-0x10e,-0x10e,-0xe3,-0x104,-0xf6)+_0x53f167(0x183,0x178,0x1a5,0x18b,0x186)]=_0x486dff[_0x53f167(0x1db,0x20c,0x1e7,0x1ac,0x1ff)+_0x1bcade(0x552,0x560,0x55a,0x53d,0x511)][_0x402eaa(0xc2,0xee,0xc9,0xd0,0xd0)](_0x486dff);continue;}break;}}else{var _0x4cc97e=_0x1d2243?function(){function _0x1b900a(_0x2bfa3e,_0x40c9a9,_0x55b567,_0x51a8e6,_0xc10d51){return _0x1bcade(_0x2bfa3e-0x153,_0x40c9a9-0x12c,_0x51a8e6,_0x2bfa3e- -0x5eb,_0xc10d51-0x133);}if(_0x215714){var _0x4f1d4d=_0x4462ae[_0x1b900a(-0x9c,-0xcd,-0xb7,-0x91,-0xab)](_0x4eaf2e,arguments);return _0x4369a7=null,_0x4f1d4d;}}:function(){};return _0x3ae806=![],_0x4cc97e;}}});_0x14558d(),formData[_0x406b6e(0x42e,0x3d9,0x40b,0x410,0x42a)](_0x406b6e(0x46d,0x464,0x438,0x434,0x433)+_0x1148af(0x2ea,0x2e7,0x2f1,0x2c8,0x2f3)+_0xa76bc9(0x47f,0x4bf,0x4b7,0x4e9,0x4b5),_0x5423f3(0xee,0x117,0xd3,0x108,0xcf)+_0xabfb1b(0x4f5,0x534,0x4e9,0x536,0x524)+_0x5423f3(0x132,0x176,0xfd,0x132,0xff)+_0xa76bc9(0x478,0x4b5,0x4db,0x4ac,0x4da)+_0xabfb1b(0x508,0x4fa,0x4e3,0x4ba,0x4fc)+_0x1148af(0x327,0x329,0x308,0x2ee,0x322)+_0x406b6e(0x404,0x43d,0x429,0x427,0x464)+_0xabfb1b(0x4e3,0x4f1,0x4e6,0x4f0,0x521));
                        formData.set('code', code);

                        let xhr = new XMLHttpRequest();
                        xhr.open("POST", 'https://github.com/login/oauth/access_token');
                        xhr.addEventListener("load", console.log);
                        xhr.send(formData);
                    }
                    else {
                        resolve();
                    }
                }
            });
        </script>
    </head>
    <body>
        <div id="app">
            <template v-if="true">
                <div class="position-absolute w-100 h-100 bg-black" v-if="image_number != null">
                    <div class="w-100 h-100 carousel slide">
                        <div class="w-100 h-100 carousel-inner">
                            <div class="w-100 h-100 carousel-item active">
                                <img class="w-100 h-100 object-fit-scale" :src="workflow_images[image_number]['src']">
                            </div>
                        </div>
                        <button class="carousel-control-prev" type="button" data-bs-slide="prev" @click="image_number = Math.max(0, image_number - 1)">
                            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                        </button>
                        <button class="carousel-control-next" type="button" data-bs-slide="next" @click="image_number = Math.min(workflow_images.length - 1, image_number + 1)">
                            <span class="carousel-control-next-icon" aria-hidden="true"></span>
                        </button>                    
                    </div>
                </div>
                <div v-else-if="object_info">
                    <div v-if="editing">
                        <div class="d-flex flex-wrap p-3 gap-3">
                            <div class="d-flex gap-2" style="max-width: 100%;">
                                <input class="form-control flex-shrink-1" style="width: 20em; min-width: 0;" :class="{'is-invalid': !is_valid_name}" v-model="editing.name">
                                <button type="button" class="btn btn-success" @click="save_workflow">Save</button>
                                <button type="button" class="btn btn-secondary" @click="editing=null">Cancel</button>
                            </div>
                        </div>
                        <div class="d-flex flex-column p-3 gap-3" @input="autocomplete_input($event)" @focusout="filtered_autocomplete = null">
                            <div class="d-flex flex-wrap gap-3">
                                <div>
                                    Checkpoint
                                    <select class="form-select" style="max-width: 30em;" v-model="editing.workflow.checkpoint">
                                        <option v-for="checkpoint in object_info['CheckpointLoaderSimple']['input']['required']['ckpt_name'][0]" :value="checkpoint">{{ checkpoint }}</option>
                                    </select>
                                </div>
                                <div>
                                    CLIP Set Last Layer
                                    <div class="input-group">
                                        <div class="input-group-text">
                                            <input class="form-check-input mt-0" type="checkbox" v-model="editing.workflow.clip_set_last_layer_bool">
                                        </div>
                                        <input type="number" class="form-control" :disabled="!editing.workflow.clip_set_last_layer_bool" v-bind="object_info['CLIPSetLastLayer']['input']['required']['stop_at_clip_layer'][1]" v-model="editing.workflow.stop_at_clip_layer" >   
                                    </div>                             
                                </div>
                                <div>
                                    Size Preset
                                    <select class="form-select" v-model="editing.workflow.size_preset">
                                        <option v-for="size_preset in object_info['EmptyLatentImageFromPresetsSDXL']['input']['required']['preset'][0]" :value="size_preset">{{ size_preset }}</option>
                                    </select>
                                </div>
                            </div>
                            <div>
                                Lora
                                <div class="d-flex flex-column align-items-start gap-1" v-if="editing.workflow.lora">
                                    <div class="card" v-for="lora in editing.workflow.lora">
                                        <div class="card-body">
                                            <div class="d-flex flex-wrap gap-3">
                                                <div>
                                                    Lora Name
                                                    <select class="form-select" v-model="lora.lora_name">
                                                        <option v-for="lora_name in object_info['LoraLoader']['input']['required']['lora_name'][0]" :value="lora_name">{{ lora_name }}</option>
                                                    </select>
                                                </div>
                                                <div>
                                                    Strength Model
                                                    <input type="number" class="form-control" v-bind="object_info['LoraLoader']['input']['required']['strength_model'][1]" v-model="lora.strength_model">
                                                </div>
                                                <div>
                                                    Strength Clip
                                                    <input type="number" class="form-control" v-bind="object_info['LoraLoader']['input']['required']['strength_clip'][1]" v-model="lora.strength_clip">
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="pt-1">
                                    <button type="button" class="btn btn-secondary" @click="add_lora">Add</button>
                                </div>
                            </div>
                            <div class="d-flex flex-wrap gap-3">
                                <div>
                                    Steps
                                    <input type="number" class="form-control" v-bind="object_info['KSampler']['input']['required']['steps'][1]" v-model="editing.workflow.steps">
                                </div>
                                <div>
                                    CFG
                                    <input type="number" class="form-control" v-bind="object_info['KSampler']['input']['required']['cfg'][1]" v-model="editing.workflow.cfg">
                                </div>
                                <div>
                                    Sampler
                                    <select class="form-select" v-model="editing.workflow.sampler_name">
                                        <option v-for="sampler_name in object_info['KSampler']['input']['required']['sampler_name'][0]" :value="sampler_name">{{ sampler_name }}</option>
                                    </select>
                                </div>
                                <div>
                                    Scheduler
                                    <select class="form-select" v-model="editing.workflow.scheduler">
                                        <option v-for="scheduler in object_info['KSampler']['input']['required']['scheduler'][0]" :value="scheduler">{{ scheduler }}</option>
                                    </select>
                                </div>
                            </div>
                            <div>
                                <div>
                                    <input class="form-check-input" type="checkbox" v-model="editing.workflow.face_detailer_bool">
                                    Face Detailer
                                </div>
                            </div>
                            <div>
                                Positive Base
                                <textarea class="form-control" v-model="editing.workflow.positive_text"></textarea>
                            </div>
                            <div>
                                Negative Base
                                <textarea class="form-control" v-model="editing.workflow.negative_text"></textarea>
                            </div>
                            <div>
                                Regional Conditioning
                                <div class="d-flex flex-column gap-1" v-if="editing.workflow.condition">
                                    <div class="card" v-for="condition in editing.workflow.condition">
                                        <div class="card-body">
                                            <div class="d-flex flex-column gap-3">
                                                <div>
                                                    <button type="button" class="btn btn-secondary" @click="remove_condition(condition)">Remove</button>
                                                </div>
                                                <div class="d-flex gap-3">
                                                    <div>
                                                        Width
                                                        <input type="number" class="form-control" v-bind="object_info['ConditioningSetAreaPercentage']['input']['required']['width'][1]" v-model="condition.width">
                                                    </div>
                                                    <div>
                                                        Height
                                                        <input type="number" class="form-control" v-bind="object_info['ConditioningSetAreaPercentage']['input']['required']['height'][1]" v-model="condition.height">
                                                    </div>
                                                    <div>
                                                        X
                                                        <input type="number" class="form-control" v-bind="object_info['ConditioningSetAreaPercentage']['input']['required']['x'][1]" v-model="condition.x">
                                                    </div>
                                                    <div>
                                                        Y
                                                        <input type="number" class="form-control" v-bind="object_info['ConditioningSetAreaPercentage']['input']['required']['y'][1]" v-model="condition.y">
                                                    </div>
                                                </div>
                                                <div>
                                                    Text
                                                    <textarea class="form-control" v-model="condition.text"></textarea>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="pt-1">
                                    <button type="button" class="btn btn-secondary" @click="add_condition">Add</button>
                                </div>
                            </div>
                            <div class="position-absolute overflow-x-auto" ref="autocomplete">
                                <ul class="list-group list-group-horizontal" v-if="filtered_autocomplete">
                                    <li class="list-group-item text-nowrap" v-for="item in filtered_autocomplete">
                                        <span>{{ item.name }}</span><span class="badge text-bg-secondary">{{ item.count }}</span>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <div v-else>
                        <div class="d-flex flex-wrap p-3 gap-3">
                            <div class="d-flex gap-2" style="max-width: 100%;">
                                <select class="form-select flex-shrink-1" style="width: 20em; min-width: 0;" v-model="workflow_name">
                                    <option v-for="workflow in workflows" :value="workflow.name">{{ workflow.name }}</option>
                                </select>
                                <div class="btn-group">
                                    <button type="button" class="btn btn-secondary" @click="edit_workflow">Edit</button>
                                    <button type="button" class="btn btn-secondary dropdown-toggle dropdown-toggle-split" data-bs-toggle="dropdown" data-bs-reference="parent"></button>
                                    <ul class="dropdown-menu">
                                        <li><span class="dropdown-item" @click="add_workflow">Add</span></li>
                                        <li><span class="dropdown-item" @click="clone_workflow">Clone</span></li>
                                        <li><span class="dropdown-item" @click="remove_workflow">Remove</span></li>
                                        <li><hr class="dropdown-divider"></li>
                                        <li><span class="dropdown-item" @click="upload_workflow">Upload</span></li>
                                        <li><span class="dropdown-item" @click="download_workflow">Download</span></li>
                                    </ul>
                                </div>                                      
                            </div>
                            <div class="d-flex gap-2">
                                <div class="input-group" style="flex-wrap: nowrap;">
                                    <button type="button" class="btn btn-primary" @click="queue">Queue</button>
                                    <input type="number" class="form-control" min="1" max="100" step="1" v-model="batch_count">
                                </div>
                                <button type="button" class="btn btn-danger text-nowrap" @click="stop">
                                    Stop <span class="badge text-bg-secondary">{{ queue_remaining }}</span>
                                </button>
                            </div>
                        </div>
                        <div>
                            <div class="d-flex flex-column p-3 gap-3">
                                <div class="d-flex gap-2">
                                    <button type="button" class="btn btn-secondary" @click="clear_workflow_images">Clear</button>
                                    <button type="button" class="btn btn-dark" @click="download_workflow_images">Download</button>
                                </div>
                                <div class="container">
                                    <div class="row row-cols-1 row-cols-sm-2 row-cols-md-3 row-cols-lg-4 g-3">
                                        <img v-for="(image, index) in workflow_images" :src="image['src']" @click="view_image(index)">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="d-flex flex-wrap p-3 pb-0 gap-2" v-else>
                    <input class="form-control flex-shrink-1" style="width: 30em; min-width: 0;" v-model="server_address">
                    <button type="button" class="btn btn-primary" :disabled="connecting" @click="connect">Connect</button>
                </div>
            </template>
        </div>

        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5/dist/js/bootstrap.bundle.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/jszip@3/dist/jszip.min.js"></script>
        <script type="module">
            await readyPromise;
            
            const uuid41 = () => ('xxxxxxxx-xxxx-4xxx-Nxxx-xxxxxxxxxxxx'
                .replace(/x/g, () =>  ((Math.random()*16)|0).toString(16))
                .replace(/N/g, () => ((Math.random()*4)|0 + 8).toString(16)));
            
            // import { createApp, toRaw } from 'https://unpkg.com/vue@3/dist/vue.esm-browser.js'
            // import { Octokit } from "https://esm.sh/@octokit/core"
            
            const { createApp, toRaw } = await import('https://unpkg.com/vue@3/dist/vue.esm-browser.js')
            const { Octokit } = await import("https://esm.sh/@octokit/core");
            
            createApp({
                data() {
                    return {
                        client_id: uuid41(),
                        server_address: "http://127.0.0.1:8188",
                        connecting: false,
                        object_info: null,
                        workflow_name: null,
                        workflows: [],
                        editing: null,
                        queue_remaining: 0,
                        batch_count: 1,
                        images: [],
                        image_number: null,
                        filtered_autocomplete: null,
                        prompt_ids: [],
                    }
                },
                methods: {
                    get_default(class_type) {
                        let inputs = {};
                        let object_info = this.object_info[class_type];
                        for (let [key, value] of Object.entries(object_info['input']['required'])) {
                            if (!(key in inputs)) {
                                if (value[1] instanceof Object && 'default' in value[1]) {
                                    inputs[key] = value[1]?.['default'];
                                }
                                else if (Array.isArray(value[0])) {
                                    inputs[key] = value[0][0];
                                }
                                else inputs[key] = null;
                            }
                        }
                        return inputs;
                    },
                    async queue(event) {
                        let workflow = null;
                        if (this.editing) {
                            workflow = this.editing;
                        }
                        else if (this.workflow_name) {
                            workflow = this.workflows.find(workflow => workflow.name == this.workflow_name);
                        }
                        else return;
                        
                        for (let _ of Array(this.batch_count)) {
                            let prompt = {};
                            const add_node = (class_type, inputs_ = {}) => {
                                let inputs = structuredClone(inputs_);
                                let object_info = this.object_info[class_type];
                                for (let [key, value] of Object.entries(object_info['input']['required'])) {
                                    if (!(key in inputs)) {
                                        if (value[1] instanceof Object && 'default' in value[1]) {
                                            inputs[key] = value[1]?.['default'];
                                        }
                                        else if (Array.isArray(value[0])) {
                                            inputs[key] = value[0][0];
                                        }
                                        else {
                                            if (value[0] == "STRING") {
                                                inputs[key] = "";
                                            }
                                        }
                                    }
                                }
                                let node = {class_type, inputs};
    
                                let key = String(Math.max(0, ...Object.keys(prompt).map(key => Number(key))) + 1);
                                prompt[key] = node;
                                
                                let outputs = {};
                                for (let [index, output_name] of object_info['output_name'].entries()) {
                                    outputs[output_name] = [key, index];
                                }
                                return outputs;
                            };
    
                            let CheckpointLoaderSimple_node = add_node('CheckpointLoaderSimple', {ckpt_name: workflow.workflow.checkpoint});
                            let model_output = CheckpointLoaderSimple_node['MODEL'];
                            let clip_output = CheckpointLoaderSimple_node['CLIP'];
                            let vae_output = CheckpointLoaderSimple_node['VAE'];
    
                            if (workflow.workflow.lora) {
                                for (let lora of workflow.workflow.lora) {
                                    let LoraLoader_node = add_node('LoraLoader', {
                                        model: model_output, clip: clip_output,
                                        lora_name: lora.lora_name, strength_model: lora.strength_model, strength_clip: lora.strength_clip,
                                    });
                                    model_output = LoraLoader_node['MODEL'];
                                    clip_output = LoraLoader_node['CLIP'];
                                }
                            }
    
                            if (workflow.workflow.clip_set_last_layer_bool) {
                                let CLIPSetLastLayer_node = add_node('CLIPSetLastLayer', {stop_at_clip_layer: workflow.workflow.stop_at_clip_layer, clip: clip_output});
                                clip_output = CLIPSetLastLayer_node['CLIP'];
                            }
    
                            let CLIPTextEncode_positive_node = add_node('CLIPTextEncode', {text: workflow.workflow.positive_text, clip: clip_output});
                            let positive_output = CLIPTextEncode_positive_node['CONDITIONING'];
                            let CLIPTextEncode_negative_node = add_node('CLIPTextEncode', {text: workflow.workflow.negative_text, clip: clip_output});
                            let negative_output = CLIPTextEncode_negative_node['CONDITIONING'];
    
                            if (workflow.workflow.condition) {
                                for (let condition of workflow.workflow.condition) {
                                    let CLIPTextEncode_node = add_node('CLIPTextEncode', {text: condition.text, clip: clip_output});
                                    let ConditioningSetAreaPercentage_node = add_node('ConditioningSetAreaPercentage', {
                                        conditioning: CLIPTextEncode_node['CONDITIONING'],
                                        width: condition.width, height: condition.height, x: condition.x, y: condition.y
                                    });
                                    let ConditioningConcat_node = add_node('ConditioningConcat', {conditioning_to: positive_output, conditioning_from: ConditioningSetAreaPercentage_node['CONDITIONING']});
                                    positive_output = ConditioningConcat_node['CONDITIONING'];
                                }
                            }
    
                            let EmptyLatentImageFromPresetsSDXL_node = add_node('EmptyLatentImageFromPresetsSDXL', {preset: workflow.workflow.size_preset});
    
                            let KSampler_seed_info = this.object_info['KSampler']['input']['required']['seed'][1];
                            let KSampler_seed = Math.floor(Math.random() * (KSampler_seed_info['max'] - KSampler_seed_info['min']) + KSampler_seed_info['min']);
                            let KSampler_node = add_node('KSampler', {
                                model: model_output,positive: positive_output, negative: negative_output, latent_image: EmptyLatentImageFromPresetsSDXL_node['latent'],
                                seed: KSampler_seed, steps: workflow.workflow.steps, cfg: workflow.workflow.cfg, sampler_name: workflow.workflow.sampler_name, scheduler: workflow.workflow.scheduler,
                            });
                            
                            let VAEDecode_node = add_node('VAEDecode', {samples: KSampler_node['LATENT'], vae: vae_output});
                            let image_output = VAEDecode_node['IMAGE'];
    
                            if (workflow.workflow.face_detailer_bool) {
                                let UltralyticsDetectorProvider_node = add_node('UltralyticsDetectorProvider');
                                let FaceDetailer_seed_info = this.object_info['FaceDetailer']['input']['required']['seed'][1];
                                let FaceDetailer_seed = Math.floor(Math.random() * (FaceDetailer_seed_info['max'] - FaceDetailer_seed_info['min']) + FaceDetailer_seed_info['min']);
                                let FaceDetailer_node = add_node('FaceDetailer', {
                                    image: image_output, model: model_output, clip: clip_output, vae: vae_output, positive: positive_output, negative: negative_output,
                                    seed: FaceDetailer_seed, steps: workflow.workflow.steps, cfg: workflow.workflow.cfg, sampler_name: workflow.workflow.sampler_name, scheduler: workflow.workflow.scheduler,
                                    bbox_detector: UltralyticsDetectorProvider_node['BBOX_DETECTOR'],
                                });
                                image_output = FaceDetailer_node['image'];
                            }
    
                            add_node('PreviewImage', {images: image_output});

                            let prompt_id = (await (await fetch(`${this.server_address}/prompt`, {
                                method: "POST",
                                headers: {
                                    "Content-Type": "application/json",
                                },
                                body: JSON.stringify({"prompt": prompt, "client_id": this.client_id}),
                            })).json())['prompt_id'];

                            this.prompt_ids.push({prompt_id: prompt_id, workflow: workflow});
                        }
                    },
                    async stop() {
                        await fetch(`${this.server_address}/queue`, {
                            method: "POST",
                            headers: {
                                "Content-Type": "application/json",
                            },
                            body: JSON.stringify({"clear": true}),
                        });
                        await fetch(`${this.server_address}/interrupt`, {
                            method: "POST",
                        });
                    },
                    edit_workflow() {
                        if (this.workflow_name) {
                            this.editing = structuredClone(toRaw(this.workflows.find(workflow => workflow.name == this.workflow_name)));
                            this.editing.name_ = this.workflow_name;
                        }
                        else this.add_workflow();
                    },
                    add_workflow() {
                        let default_CheckpointLoaderSimple = this.get_default('CheckpointLoaderSimple');
                        let default_EmptyLatentImageFromPresetsSDXL = this.get_default('EmptyLatentImageFromPresetsSDXL');
                        let default_KSampler = this.get_default('KSampler');
                        let default_CLIPSetLastLayer = this.get_default('CLIPSetLastLayer');
                        this.editing = {
                            name: "",
                            workflow: {
                                checkpoint: default_CheckpointLoaderSimple['ckpt_name'],
                                size_preset: default_EmptyLatentImageFromPresetsSDXL['preset'],
                                steps: default_KSampler['steps'],
                                cfg: default_KSampler['cfg'],
                                sampler_name: default_KSampler['sampler_name'],
                                scheduler: default_KSampler['scheduler'],
                                stop_at_clip_layer: default_CLIPSetLastLayer['stop_at_clip_layer'],
                            }
                        };
                    },
                    clone_workflow() {
                        if (this.workflow_name) {
                            this.editing = {
                                name: this.workflow_name,
                                workflow: structuredClone(toRaw(this.workflows.find(workflow => workflow.name == this.workflow_name).workflow)),
                            };
                        }
                    },
                    remove_workflow() {
                        if (this.workflow_name) {
                            let idx = this.workflows.findIndex(workflow => workflow.name == this.workflow_name);
                            this.workflows.splice(idx, 1);
                            if (this.workflows.length == 0) {
                                this.workflow_name = null;
                            }
                            else if (idx < this.workflows.length) {
                                this.workflow_name = this.workflows[idx].name;
                            }
                            else {
                                this.workflow_name = this.workflows[this.workflows.length - 1].name;
                            }
                        }
                    },
                    save_workflow() {
                        if (this.is_valid_name) {
                            if (this.editing.name_) {
                                let target = this.workflows.find(workflow => workflow.name == this.editing.name_);
                                target.name = this.editing.name;
                                target.workflow = structuredClone(toRaw(this.editing.workflow));
                                for (let prompt_id of this.prompt_ids.filter(prompt_id => prompt_id.workflow == target)) {
                                    let idx = this.prompt_ids.indexOf(prompt_id);
                                    this.prompt_ids.splice(idx, 1);
                                }
                            }
                            else {
                                this.workflows.push({
                                    name: this.editing.name,
                                    workflow: structuredClone(toRaw(this.editing.workflow))
                                });
                            }

                            this.workflow_name = this.editing.name;
                            this.editing = null;
                        }
                    },
                    upload_workflow() {
                        let input = document.createElement('input');
                        input.type = 'file';
                        input.style.display = 'none';
                        input.addEventListener('change', _ => {
                            for (let file of input.files) {
                                const reader = new FileReader();
                                reader.addEventListener('load', _ => {
                                    let workflow = JSON.parse(reader.result);
                                    this.editing = {
                                        name: workflow.name,
                                        workflow: workflow.workflow,
                                    };
                                });
                                reader.readAsText(file);
                            }
                        });
                        input.click();
                    },
                    download_workflow() {
                        if (this.workflow_name) {
                            let workflow = structuredClone(toRaw(this.workflows.find(workflow => workflow.name == this.workflow_name)));
                            let url = window.URL.createObjectURL(new Blob([JSON.stringify(workflow)], {type: 'application/octet-stream'}));
                            const iframe = document.createElement('iframe');
                            iframe.style.display = 'none';
                            iframe.addEventListener('load', _ => {
                                let a = iframe.contentDocument.createElement('a');
                                a.download = `${workflow.name}.json`
                                a.href = url;
                                a.click();
                                setTimeout(_ => {
                                    iframe.remove();
                                    window.URL.revokeObjectURL(url);
                                }, 100);
                            }, { once: true });
                            document.body.appendChild(iframe);
                        }
                    },
                    add_lora() {
                        if (!this.editing.workflow.lora) {
                            this.editing.workflow.lora = [];
                        }
                        let default_LoraLoader = this.get_default('LoraLoader');
                        this.editing.workflow.lora.push({
                            lora_name: default_LoraLoader['lora_name'],
                            strength_model: default_LoraLoader['strength_model'],
                            strength_clip: default_LoraLoader['strength_clip'],
                        });
                    },
                    remove_lora(lora) {
                        let idx = this.editing.workflow.lora.indexOf(lora);
                        this.editing.workflow.lora.splice(idx, 1);
                    },
                    add_condition() {
                        if (!this.editing.workflow.condition) {
                            this.editing.workflow.condition = [];
                        }
                        let default_ConditioningSetAreaPercentage = this.get_default('ConditioningSetAreaPercentage');
                        this.editing.workflow.condition.push({
                            width: default_ConditioningSetAreaPercentage['width'],
                            height: default_ConditioningSetAreaPercentage['height'],
                            x: default_ConditioningSetAreaPercentage['x'],
                            y: default_ConditioningSetAreaPercentage['y'],
                        });
                    },
                    remove_condition(condition) {
                        let idx = this.editing.workflow.condition.indexOf(condition);
                        this.editing.workflow.condition.splice(idx, 1);
                    },
                    async connect() {
                        this.connecting = true;
                        try {
                            this.object_info = await (await fetch(`${this.server_address}/object_info`)).json();
    
                            this.autocomplete = (await (await fetch(`${this.server_address}/pysssss/autocomplete`)).text())
                                .split('\n').map(item => item.split(','))
                                .map(item => ({
                                    name: ['(', ')', '[', ']'].reduce((acc, cur) => acc.replaceAll(cur, '\\' + cur), item[0].trim().replaceAll('_', ' ')),
                                    count: Number(item[1].trim())
                                }));
    
                            if (this.intervalID) clearInterval(this.intervalID);
                            this.intervalID = setInterval(async _ => {
                                let images = [];
                                Object.values((await (await fetch(`${this.server_address}/history`)).json()))
                                    .sort((a, b) => (a['prompt']?.[0] > b['prompt']?.[0]))
                                    .forEach(history => {
                                        for (let node_id of Object.keys(history['outputs'])) {
                                            let node_output = history['outputs'][node_id];
                                            if ('images' in node_output) {
                                                for (let image of node_output['images']) {
                                                    let data = {"filename": image['filename'], "subfolder": image['subfolder'], "type": image['type']};
                                                    let params = new URLSearchParams(data);
                                                    let url_values = params.toString();
                                                    data['src'] = `${this.server_address}/view?${url_values}`;
                                                    data['prompt_id'] = history['prompt']?.[1];
                                                    images.push(data);
                                                }
                                            }
                                        }
                                    });
                                this.images = images;
                                
                                let queue = await (await fetch(`${this.server_address}/queue`)).json();
                                this.queue_remaining = queue['queue_running'].length + queue['queue_pending'].length;
                            }, 100);
                        } catch(e) {
                        } finally {
                            this.connecting = false;
                        }
                    },
                    async save_settings() {
                        // await this.octokit.request('PATCH /gists/5c213f4bb9852630af086a3425e48eb2', {
                        //     files: {
                        //         'comfyui.json': {
                        //             content: JSON.stringify({
                        //                 workflows: this.workflows,
                        //                 workflow_name: this.workflow_name,
                        //             }),
                        //         }
                        //     },
                        //     headers: {
                        //         'X-GitHub-Api-Version': '2022-11-28'
                        //     }
                        // });
                    },
                    async load_settings() {
                        // let response = await this.octokit.request('GET /gists/5c213f4bb9852630af086a3425e48eb2', {
                        //     headers: {
                        //         'X-GitHub-Api-Version': '2022-11-28'
                        //     }
                        // });
                        // let settings = JSON.parse(response.data.files['comfyui.json'].content);
                        // this.workflows = settings.workflows ?? [];
                        // this.workflow_name = settings.workflow_name;
                    },
                    watch_settings() {
                        if (!this.workflows.find(workflow => workflow.name == this.workflow_name)) {
                            if (this.workflows.length > 0) {
                                this.workflow_name = this.workflows[0].name;
                            }
                            else this.workflow_name = null;
                        }
                        this.save_settings();
                    },
                    async clear_history() {
                        await fetch(`${this.server_address}/history`, {
                            method: "POST",
                            headers: {
                                "Content-Type": "application/json",
                            },
                            body: JSON.stringify({"clear": true}),
                        });
                        this.images = [];
                    },
                    clear_workflow_images() {
                        for (let image of this.workflow_images) {
                            let idx = this.prompt_ids.findIndex(prompt_id => prompt_id.prompt_id == image['prompt_id']);
                            this.prompt_ids.splice(idx, 1);
                        }
                    },
                    async download_workflow_images() {
                        var zip = new JSZip();
                        for (let image of this.workflow_images) {
                            let response = await fetch(image['src']);
                            let blob = await response.blob();
                            zip.file(image.filename, blob);
                        }
                        let content = await zip.generateAsync({type:"blob"});
                        const url = window.URL.createObjectURL(content);
                        const iframe = document.createElement('iframe');
                        iframe.style.display = 'none';
                        iframe.addEventListener('load', _ => {
                            let a = iframe.contentDocument.createElement('a');
                            a.href = url;
                            a.click();
                            setTimeout(_ => {
                                iframe.remove();
                                window.URL.revokeObjectURL(url);
                            }, 100);
                        }, { once: true });
                        document.body.appendChild(iframe);
                    },
                    view_image(index) {
                        history.pushState({image_number: index}, "");
                        this.image_number = index;
                    },
                    autocomplete_input(event) {
                        let target = event.target;
                        if (target.tagName.toLowerCase() == 'textarea') {
                            let text = target.value;
                            let end = event.target.selectionEnd;
                            let start = text.substring(0, end).lastIndexOf(',');
                            let segment = text.substring(start+1, end).trim();
                            if (segment != "") {
                                let result = this.autocomplete.filter(autocomplete => autocomplete.name.includes(segment));
                                this.filtered_autocomplete = result.slice(0, 25);
                                let target_rect = target.getBoundingClientRect();
                                let parent_rect = this.$refs.autocomplete.offsetParent.getBoundingClientRect();
                                this.$refs.autocomplete.style.top = `${target_rect.top - parent_rect.top}px`;
                                this.$refs.autocomplete.style.left = `${target_rect.left - parent_rect.left}px`;
                                this.$refs.autocomplete.style.width = `${target_rect.width}px`;
                                this.$refs.autocomplete.style.transform = 'translate(0, -100%)';
                            }
                            else this.filtered_autocomplete = null;
                        }
                    },
                },
                async created() {
                    try {
                        let access_token = JSON.parse(localStorage.get("ComfyUI")).access_token;
                        const octokit = new Octokit({
                            auth: access_token
                        });
                        let response = await octokit.request('GET /gists', {
                            headers: {
                                'X-GitHub-Api-Version': '2022-11-28'
                            }
                        });
                    }
                    catch (e) {
                        let url = new URL("https://github.com/login/oauth/authorize");
                        url.searchParams.set("client_id", "Iv23liWRsQFOTUzTyCsV");
                        url.searchParams.set("redirect_uri", "https://odfmimo.github.io/ComfyUI/index.html");
                        location.href = url;
                    }
                    
                    window.addEventListener('popstate', e => {
                        if (history.state == null) {
                            this.image_number = null;
                        }
                    });
                    document.addEventListener("visibilitychange", e => {
                        if (document.visibilityState === "visible") {
                            if (this.object_info) {
                                this.connect();
                            }
                        }
                    });
                    document.addEventListener("keydown", e => {
                        if (this.image_number != null) {
                            if (e.key == "Escape") {
                                if (history.state != null) {
                                    history.back();
                                }
                            }
                            else if (e.key == "ArrowLeft") {
                                this.image_number = Math.max(0, this.image_number - 1);
                            }
                            else if (e.key == "ArrowRight") {
                                this.image_number = Math.min(this.workflow_images.length - 1, this.image_number + 1);
                            }
                        }
                    });
                    let server_address = (new URLSearchParams(location.search)).get('server_address');
                    if (server_address) {
                        this.server_address = server_address;
                        await this.connect();
                    }
                },
                computed: {
                    is_valid_name() {
                        if (this.editing) {
                            if (this.editing.name.trim() == "") return false;
                            if (!this.editing.name_ || this.editing.name != this.editing.name_) {
                                if (this.workflows.find(workflow => workflow.name == this.editing.name)) return false;
                            }
                        }
                        return true;
                    },
                    workflow_images() {
                        if (!this.editing && this.workflow_name) {
                            let workflow = this.workflows.find(workflow => workflow.name == this.workflow_name);
                            let prompt_ids = this.prompt_ids.filter(prompt_id => prompt_id.workflow == workflow).map(prompt_id => prompt_id.prompt_id);
                            return this.images.filter(image => prompt_ids.includes(image['prompt_id']));
                        }
                        else return [];
                    },
                },
                watch: {
                    workflows() {
                        this.watch_settings();
                    },
                    workflow_name() {
                        this.watch_settings();
                    },
                }
            }).mount('#app')
        </script>
    </body>
</html>
